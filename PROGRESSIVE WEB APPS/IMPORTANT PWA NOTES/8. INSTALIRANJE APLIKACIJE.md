# APP INSTALL PROMPT

KAKO Pete Le Page

Chrome handles most of the heavy lifting for you:

- On mobile, Chrome will generate a WebAPK, creating an even more integrated experience for your users.
- On desktop, your app will installed, and run in an app window.

O OVOME SAM NESTO REKAO U [MANIFEST](https://github.com/Rade58/apis_trying_out_and_practicing/blob/master/PROGRESSIVE%20WEB%20APPS/IMPORTANT%20PWA%20NOTES/5.%20MANIFEST.md#app-install-prompt) md FAJLU

U PREDHODNOM LINKU SAM OSTAVIO I LINKOVE KOJI SE ODNOSE NA KRITERIJUME, KOJI SE MORAJU ISPUNITI U DRUGIM BROWSER-IMA, KAKO BI UOPSTE KORISNICI BILI PROMPTED DA INSTALIRAJU APP, U SLUCAJU DRUGIH BROWSER-A

What are the criteria?
In order for a user to be able to install your Progressive Web App, it needs to meet the following

## KRITERIJUMI

[KRITERIJUMI](https://developers.google.com/web/fundamentals/app-install-banners/#criteria)(PROCITAJ CLANAK SA WEB FUNDAMENTALS-A, JEDNOG OD GOOGLE DEV CLANAKA)

What are the criteria?
In order for a user to be able to install your Progressive Web App, it needs to meet the following criteria:

- APP NE SME BITI PREDHODSNO INSTALIRAN

- U MANIFESTU: prefer_related_applications PROPERTI NE SME BITI true

POMENUTO SE ODNOSI DA RELATED NATIVE APLIKACIJA NE SME BITI INSTALIRANA

- MORA DA ZADOVOLJI **user engagement heuristic** (TRENUTN OSE ONE DEFINISU, DA KORISNIK MORA IMATI INTERAKCIJU SA APLIKACIJOM BAREM 30 SEKUNDI)

- MORA POSTOJATI APP MANIFEST SA SLEDECIM DEFINISANIM PROPERTIJIMA:

1 . **short_name** ILI **name**

2. MORAJU U MANIFESTU BITI UVRSTENE ICONS OD 192px I 512px

3. start_url PROPERTI MORA BITI DEFINISAN

4. **display** PROPERTI MORA IMATI JEDNU OD SLEDECIH VREDNOSTI: **fullscreen** ILI **standalone** ILI **minimal-ui**

- APLIKACIJA MORA BITI SERVED PREKO **HTTPS** (required for service workers)

- **APLIKACIJA MORA IMATI REGISTROVAN SERVICE WORKER, SA fetch EVENT HANDLER-OM**

>>> If the web app manifest includes related_applications and has "prefer_related_applications": true, the native app install prompt will be shown instead.

## APLIKACIJA KOJU SAM JA DEFINISAO

JA SAM MOJOJ APLIKACIJE, PORED SVAGA POMENUTOGA ZAISTA DEFINISAO I SERVICE WORKER, JER SAM SE POIGRAVAO SA NJIM, ODNOSNO KORISTIO SAM Cache U EVENT HANDLERIMA SERVICE WORKER-A

INCIDENTALNO SAM UVIDEO DA SE POJAVILA OPCIJA U CHROME BROWSER-U, PRITISKOM DA TRI TACKICE DESNO OTVORIM MENU (MENU KOJIM SE PRISTUPA I DEV TOOLS-U, I OSTALIM FEATURE-IMA)

MEDJU POMENUTIM OPCIJAMA MENIJA POSTOJI I OPCIJA ZA INSTALIRANJE APLIKACIJE

**APLIKACIJA JE INSTLLABLE I NA DESKTOPU** (U MOM SLUCAJU NA WINDOWS-U)

## BANNER, KOJI SE U VERZIJAMA CHROME-A, ISPOD 67 (UKLJUCUJUCI I NJU), JE UKLONJEN ZA VERZIJU 68, I VISE SE NE POJAVLJUJE

ALI I DALJE MORAM IMATI NJEGA U VIDU, PROSTO ZBOG ONIH KOJI KORISTE STARIJE VERZIJE CHROME BROWSER-A

## beforeinstallprompt (EVENT KOJI MOGU SLUSATI KAKO BI DEFINISAO DA SE APLIKACIJA INSTALIRA, KADA KORISNIK, NA PRIMER PRITISNE NEKO DUGME)

**PRVO DA KAZEM DA JE TO EVENT, CIJI SE HANDLER KACI NA window OBJEKAT**

NAIME, TO JE EVENT, KOJI SE TRIGGER-UJE, NAKON STO SU SVI POMENUTI [KRITERIJUMI](#kriterijumi) ISPUNJENI

SADA CU DEFINISATI, ZA MOJU APLIKACIJU, DA SE POJAVI INSTALL PROMPT, KADA KORISNIK NAPRAVI NEKI ACTION

U MOJOJ APLIKACIJI IMA TRI JAVASCRIPT FAJLA

JEDAN JE app.js U KOJEM ZELIM DA REGISTRUJEM MOG SERVICE WORKER-A, I U KOJE MZELIM DA SLUSAM **beforeinstallprompt** EVENT, DRUGI JE FAJLA SAMOG SERVICE WORKER-A sw.js,  A TRECI JE feed.js, U KOJEM MANIPULISEM DOM-OM

(NARAVNO SAMO app.js I feed.js IMAJU SVOJE scrip TAGOVE U HTML-U) (SAMO NAPOMINJEM IAKO TO NIJE RELEVANTNO ZA KONKRETNU TEMU OVOG md FAJLA)

- ZA POCETAK CU REGISTROVATI SERVICE WORKERA, U NJEMU KREIRATI I ON fetch HANDLER (PORED OSTALIH HANDLERA oninstall ILI onactive (KOJE BIH KORISTIO ZA CACH-IRANJE STATICNIH ASSET-OVA I BRISANJE STARIJIH VERZIJA CACHE-A, STO SADA NECU POKAZATI JER NIJE RELEVATNO ZA TEMU; *DAKLE SAMO KREIRAM ON **fetch** HANDLER*))

**app.js** FAJL:

```javascript
if('serviceWorker' in window.navigator){
    window.onload = function(){
        window.navigator.serviceWorker.register('/sw.js')
        .then(function(ev){
            console.log('service worker registering...');
        })
    }
}
```

**sw.js** FAJL:

```javascript
self.addEventListener('fetch', function(ev){

// ev.respondWith()

});

```

**feed.js** FAJL: *NECU JOS OVDE NEISTA DODAVATI, ALI CISTO DA ZANAM DA CU U OVOM FAJLU PRISTUPITI JEDNOM DUGMETU MOG UI I DEFINISATI DA SE INSTALL PROMPT POJAVI ON CLICK (ALI DAKLE TO CU TEK NA KRAJU URADITI)*

- DEFINISANJE ON **beforeinstallprompt** HANDLERA U app.js FAJLU; ZATIM PREVENTING DEFAULT BEHAVIOuR-A

**app.js** FAJL:

```javascript
if('serviceWorker' in window.navigator){
    window.onload = function(){
        window.navigator.serviceWorker.register('/sw.js')
        .then(function(ev){
            console.log('service worker registering...');
        })
    }

    // KACENJE ON       beforeinstallprompt        HANDLERA

    window.addEventListener('beforeinstallprompt', function(ev){
        // AKO JE REC O STARIJEM CHROME BROWSER-U, MORAM SPRECITI AUTOMATSKI PROMPTING
        ev.preventDefault();


    });

}
```

- *MEDJUTIM PROPUSTIO SAM DA SACUVAM REFERENCU **BeforeInstallPrompt** INSTANCE*

ONA CE MI NAIME BITI POTREBNA IZVAN OBIMA HANDLER-A

**app.js** FAJL:

```javascript
// VARIJABLA KOJA TREBA DA REFERENIRA     BeforeInstallPrompt     INSTANCU, IZVAN
//   ON  beforeinstallpromt HANDLER-A
let befEv;

    window.addEventListener('beforeinstallprompt', function(ev){
        ev.preventDefault();

        // ASSIGNMENT POMENUTOJ, GLOBALNOJ VARIJABLI
        befEv = ev;

        //
    });
```

SKORA SAM ZAVRSIO SA DEFINISANJEM ONOGA STO JE RELATED TO INSTALL PROMPT U MOM app.js FAJLU

ALI NISAM OBJASNIO ZASTO CUVAM REFERENCU EVENTA

OVO PISE U CLANKI

>>> **When the beforeinstallprompt event has fired, save a reference to the event, and update your user interface to indicate that the user can add your app to their home screen.**

**DAKLE, POTREBNO JE CITATI NESTO SA BeforeInstallPrompt INSTANCE; A KONKRETNO CU JE KORISTITI U onclick HANDLERU, NEKOG UI DUGMETA; I PREDPOSTAVLJAM DA CE SE SA POMENUTE INSTANCE, MOCI PROCITATI KADA JE APLIKACIJA ADDED TO HOMESCREEN, KAKO BIH MOGOA DODELITI null ON beforeinstallprompt HANDLERU window OBJEKTA, CIME BIH ZAUSTAVIO PONOVNO INSTALIRANJE ON BUTTON CLICK**

```javascript

```

## INSTALIRANJE NA ANDROID UREDJAJU, UZ KORISCENJE CHROME-OVOG REMOTE DEBUGGING-A
