# HANDLOVANJE DISPATCHED ACTION-A

ZA SADA SU TI KOMBINOVANI I card-reducer I list-reducer

## TI CES MORATI DA HANDLE-UJES ACTION U CARD REDUCERU I U LIST REDUCERU

> > We're done with the React portion of everything. The rest of this all happens now in Redux land, because React is already made aware of when any of the state changes.

> > We just need to tell Redux, hey, a thing happened, can you update the state of our application to reflect that?

> > And It'll be like, yeah, sure can if you just tell me how to do it

## IDEM PRVO U `card-reducer.js`

```javascript
import { cards as defaultCards } from "../normalized-state";

// KREIRACU PRVO KONSTANTU, KOJA NOSI IME TYPE-A, ACTION-A
const CARD_CREATE = "CARD_CREATE";

const cardReducer = (cards = defaultCards, action) => {
  // ZAATIM CU SASDA UKLONITI OVO LOGGOVANJE OD RANIJE

  // console.log(cards, action)

  // ZNAS DA JE OVAJ REDUCER PORED list-reducera ISTO KOMBINOVAN

  // MORAM PISATI USLOVNU IZJAVU JER KAO STO ZNAS EVERY ACTION CE OVDE BITI VIDLJIV NAKON DISPATCHINGA
  // JER SU OVI INDIVIDUALNI REDUCERI SAMO ABSTRAKCIJA DA BI IMAO SPLLITED CODE, ODNOSNO PODELJNE FAJLOVE ZA SVAKI REDUCER
  // ALI MOGU SMATRATI DA JE TO JEDAN VELIKI REDUCER (MOJE SAGLEDAVANJE)

  if (action.type === CARD_CREATE) {
    // IZ PAYLOADA, IZDVAJAM NOVI ID, NOVOG CARDA, I IZDVAJAM entities

    // TO JE ONO STA SE DODAJE PRILIKOM DISPATCHING-A (POGLEDAJ CardContainer I BICE TI JASNIJE)

    // JEDNO JE cardId A DRUGO JE DATA (KOJE JE KORISNIK UNEO)

    const { cardId, card } = action.payload;

    // A ONO STA TREBA BITI RETURNED JESTE NOVI OBJEKAT

    // TREBAS VODITI RACUNA DA, ILI IMATI NA UMU DA SE OVDE RADI SAMO O CARDS DELU DRVETA

    // OVAJ REDUCER DOBIJA SAMO cards (JER KAO STO REKOH, TAKO SI I NA POCETKU NORMALIZOVAO PODATKE)
    // TAK OSI IH PODELIO

    return {
      entities: { ...cards, [cardId]: card },
      ids: [...cards.ids, cardId]
      // ids NIZ NE KORISTI NISTA ZA SADA UMOM APP-U A NITI CE KORISTITI
      // ALI DOBRO JE KADA SE KREIRAJU I
      // AKO U BUDUCNOSTI NESTO TAKVO BUDE TREBALO UI-U

      // ODNONO DA IMAS ALL CARDS VIEW U INTERFACE TVOG APP, TO BI TI TREBALO
      // ps. FORWARD THINKING FOR YOUR DEVELOPER FRIENDS
    };
  }

  return cards;
};

export default cardReducer;
```

**MEDJUTIM OPET DA KREIRAM CARD ON OPET NE BI BIO DODAT U UI**

ONO STO JE IMPORTANT JESTE DA SADA KADA BIH DODAO NOVI CARD, ON BI BIO DODAT STATE=U ALI SE NE BI RENDR-OVAO

LIST IDE THROU IT'S ARRAY OF CARD ID-S, AND DOES EACH ONE OF THEM

TAKO DA BIH MORA ODA SLUSAM NA OVAJ ACTION, NA DVA MESTA

MORAM DA GA SLUSAM U list-reducer -U, TAKODJE

**DAKLE DODAVANJEM NOVOG CARD-A STATE JESTE PROMENJENO, ALI list-reducer NE RADI NISTA SA PODACIMA, VEC SAMO VRACE CURRENT STATE; A U OVOM SLUCAJU, TAJ STATE JE STATE, SA ONIM NORMALIZED PODACI LISTE**

## ZA SADA LIST REDUCER RETURN-UJE PREVIOUS STATE, ODNONO CURRENT STATE

JA DAKLE U TOM REDUCER-U ISTO MORAM INTERCEPTOVATI 'CARD_CREATE' ACTION

```javascript
import { lists as defaultLists } from "../normalized-state";

// REKAO SAM RANIJE DA MORAM NA 'CREATE_CARD' ACTIOPN SLUSATI NA DVA MESTA
// DRUGO MESTO JE list-reducer

// DAKLE PRE NEGO STO SAM SVE DEFINISAO, OVAJ REDUCER JE VRACAO SAMO lists

// I ZATO SE NIJE MOGLO NISTA RENDEROVATI, NAIME NIJE BILO PROMENE STATE-A

const CARD_CREATE = "CARD_CREATE";

const listsReducer = (lists = defaultLists, action) => {
  // OPET SLUSAM ZA       'CARD_CREATE' TIP ACTION-A

  if (action.type === CARD_CREATE) {
    // TREBACE MI cardId  I listId IZ PAYLOAD-A

    const { listId, cardId } = action.payload;

    // MORAM GRAB-OVATI I NOVI SET ENTITY-JEVA

    // MORAS DA ZAPAMTIS DA NE MOZEMO SAMO MODIFILOVATI     list.entities

    // MORAS RETURN-OVATI NOVI OBJEKAT

    //                            JER KADA REDUX KAZE       "HERE'S A NEW STATE OF THE WORLD"

    //                            REACT TREBA DA KAZE       "OH, OVO JE DIFFERENT OBJECT"

    // MORAM NAPRAVITI KOMPIJU OF list.entities     (TO JE PREVIOUS STATE)

    const entities = { ...lists.entities };

    // SADA MORAM DA UZMEM listId KOJ IJE PROSLEDJEN PRI KREIRANJU CARD-A (ZATO STO SE CARD PRIPADA ODREDJENOJ LISTI)

    // DAKLE UZIMAM GORNJI, NOVOKREIRANI entities OBJEKAT, KOJI IMA U SEBI SVE LISTE
    // I PRISTUPAM SAMO JEDNOJ LISTI, ZA KOJU SE CARD PRAVI

    // I NARAVNO IZ PAYLOAD-A SAM UZEO ID TE LEISTE

    // VRSIM OVERRIDING SA LISTOM, KOJA TREBA DA IMA NOVI CARD U SEBI

    entities[listId] = {
      ...entities[listId], // SPRED-UJEM SVE

      // UBACUJEM I NOVI CARD MEDJU CARD-OVE

      cards: [...entities[listId].cards, cardId]
    };

    // ONO STO RETURN-UJEM JESU SVE LISTE, A ALI ZAJEDNO SA PROMENJENOM LISTOM

    return {
      ...lists, // STARI lists    JE IMAO PROPERTI        entities
      entities // OVDE GA OVERRIDE-UJES SA NOVIM entities
    };

    // NARAVNO VRATIIO SI NOVI OBJEKAT
  }

  // OVO MORA DA OSTANE OVDE NARAVNO

  return lists;
};

// DOBRO SADA IZVOZIM OVVU FUNKCIJU

export default listsReducer;
```

**OVO JE SVE TAKO CONFUSING**

IMAM PROBLEM PRI KOJEM JE MOGUCE DODATTI NOVI CARD ALI NE STO NE FUNKCIONISE SA STATE-OM, TAKO DA SE OSTALI CAR-OVI, U BILO KOJOJ LISTI, NE RENDERUJU
