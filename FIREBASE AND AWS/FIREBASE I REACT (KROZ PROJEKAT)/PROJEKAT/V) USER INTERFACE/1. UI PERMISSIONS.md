# UI PERMISSIONS

ZELIM DA OBAVIM SADA, A LITTLE BIT OF CLEANING OF USER INTERFACE

## DA LI SE SECAH KAD SI IMPLEMENTIRAO SECURIT RULES FOR DOCUMENTS IN 'posts' COLLECTION; E PA TADA SI ZABRANIO DA KORISNIK KOJI NIJE AUTHORIZED, USTVARI NE MOZE DA VRSI update I create POST DOKUMENTA, I DA NE MOZE DA VRSI delete POST DOKUMENATA, KOJE SU KREIRALI DRUGI KORISNICI, VEC DAKLE MOZE SAMO DA UKLONI SOPSTVENI DOKUMENT

STO SE TICE read-A, ON JE DOZVOLJEN ZA POSTS, TO ME MALO ZABRINJAVA IAKO MI JE SADA U OVOM DELU TUTORIJALA UI U PRVOM PLANU (ONO STO ME ZABRINJAVA JESTE DA BI RECIMO MALICIOZNI KORISNIK ODLUCIO DA POSALJE VELIKI BROJ REQUEST-OVA ZA POST-OVIMA, ODNOSNO GETT-OVAO VELIKI BROJ SNAPSHOT-OVA I TIME POVECAO CENU KOJ UBI JA MORAO PLATITI FIREBASE-U, ILI CIME BI MOZDA PREKORACIO FREE PLAN) (MOZDA CU O TOME USKORO GOVORITI A MOZDA I NECU, UGLAVNOM OKRECEM SE KA UI U OVOM DELU TUTORIJALA)

POGLEDAJ SECURITY RULES:

```javascript
rules_version = '2';
service cloud.firestore {

  match /databases/{database}/documents {

    // EVO IH OVDE
    match /posts/{postId} {
      allow read;
      allow create, update: if request.auth.uid != null && request.resource.data.title != "";
      allow delete: if request.auth.uid == resource.data.user.uid;
    }

    match /users/{userId} {
      allow read;
      allow write: if userId == request.auth.uid;
    }

  }

}
```

## :o: PROBLEM :one: : ONO STO MEDJUTIM ZNAM DA JE SIGURNO SPORNO ALI JESTE UI U KOJI PRIKAZUJE POSTOVE, JE ON JE POTPUNO OTKRIVEN ZA UNAUTHORIZED KORISNIKE; TAKODJE SVAKI RENDERED POST U UI, IMA DEO ZA DELETION, KOJI JE TAKODJE OTKRIVEN, A SVAKO TO DELETE DUGME TRIGGER-UJE DELETING POSTA

POST SE NECE DELET-OVATI KADA UNAUTHORIZED KORISNIK, ILI KORISNIK KOJI GA NIJE KREIRAO, USTVARI KLIKNE NA DUGME

DESICE SE ONAJ KRATKOTRAJNI REMOVIG POSTA, JER KAO STO KAZE STEVE KINNEY, FIRESTORE CE POKUSATI OPTIMISTIC UPDATE, ON SNAPSHOT

ALI CE SE ZBOG PODESENIH PRAVILA ODMAH TAJ ISTI POST VRATITI, ODNOSNO PONOVO CE SE DESITI TRIGGERING ON SNAPSHOTA, ALI OVOG PUTA ONAJ POST KOJEG JE UNAUTHORIZED KORISNIK, ILI KORINIK KOJI GA NIJE KREIRAO, BICE OPET DEO SNAPSHOT-A

**I OVDE GOVORIM O MILISEKUNDAMA, ALI TO JE DOVOLJNO VREMENA DA SE POMENUTI RERENDERING PRIMETI**

**A U KONZOLI FIREBASE CE OUTPUT-OVATI ERROR (UGLAVNOM THREAD NECE BITI BLOKIRAN)** 

DAKLE MORAM IMATI NA UMU DA SVAKI INTERACTION SA FIRESTORE DATABASE-OM, MOZE IZAZVATI TRIGGERING ON SNAPSHOT EVENT-A

## ## :o: PROBLEM: :two: : JOS JEDNA STVAR; AddPost KOMPONENTA JE UVEK EXPOSED, BEZ OBZIRA DA LI JE KORISNIK AUTHORIZED ILI NE

TO ZNACI DA SU FORMULARI EXPOST

I TO ZNACI DA CE KORISNIK OPET BITI 'YELLED AT', KADA BUDE ZELO DA KREIRA POST (ODNOSNO OPET TRIGGERING ON SNAPSHOT, I ONO KRATKOTRAJNO DODAVANJE NOVOG POSTA-A, U OPET NOVI TRIGGERING ISTOG EVENTA I VRACANJE STATE APLIKACIJE NA ISTO, BEZ NOVOG POST-A)

## TREBALO BI POMENUTO DA POPRAVIM

DAKLE TREBALO BI DA NE DISPLAY-UJEM DELETE DUGME ONOM KORISNIKU KOJI TA JDELETE NIJE KREIRAO; ALI PREDPOSTAVLJAM DA CU OVDE BITI JOS OPREZNIJI; ODNOSNO BOLJE BI BILO FUNKCIONALNOST DELET-A STAVITI U KOMPONENTU, IZ KOJE OPET MOGU HOOK-OM PULLOVATI OUT TU FUNKCIONALNOST SAMO U POSTU CIJI SE uid (AKO SE SECAJ POSTA I NJEMU SI PROSLEDJIVAO user DEO (U KOJEM JE I uid KORISNIKA KOJI JE KREIRAO POST (**TU MOGU KOREKTNIJE RECI DA SAM PROSLEDIO METADATA POST-A**))) POKLAPA SA uid-JEM, PRIJAVLJENOG KORISNIKA

I TREBAL OBI DA SE AddPost RENDER-UJE SAMO ZA AUTHORIZED KORISNIKA; I ZA OVO MISLIM DA JE DOBRO ISKORISTITI HOOKS (ZAPAMTI DA SI VEC RANIJE KREIRAO PROVIDER KOMPONENTU, A VALUE, KOJI SI PROSLEDJIVAO JESTE user); AKO user NIJE null, TREBLO BI DA CONTININALY RENDER-UJE I AddPost