# ROUTING TO DOCUMENT DATA

DAKLE, UZ POMOC ROUTER-A, JA SAM U PROSLOM FAJLU DAFINISAO DA SE NA ODREDJENOM PATH-U, KOJI JE IZMEDJU OSTALOG SAGRADJEN OD DOKUMENT-OVOG ID-JA ('/posts/:id'); RENDERUJE MOJA APLIKACIJA; A IZMEDJU OSTALIH STVARI ONO STO CE SE RENDEROVATI, KAO POSLEDICA UPOTREBE ROUTER-A, JESTE ONO STO REPREZENTUJE PostPage KOMPONENTA

## /posts/:id JA, MOJIM SLOBODNIM JEZIKOM RECENO JE PREVISE 'DOPUSTIVO' (MOJE RECI)

ONO MI OMOGUCAVA DA OTVRIM DINAMICKIM NACINOM, MOJ PATH

**PRECIZNIJE RECENO: АКО KORISNIK KLIKNE NA LINK, KOJ IBI IZGLEDAO OVAKO:** : 'posts/biloSta' *U ADRESS BARU BICE DODATA, MENTIONED EKSTENZIJA, ODNOSNO MENTIONED PATH* 

A BICE RENDERED ONO STO SAM DEFINISAO DA BUDE RENDERED KROZ Router

TREBAM IMATI NA UMU SLEDECE

- U JEDNOSJ KOMPONENTI NALAZI SE 

```jvascript
<Route exact path="/posts/:id" component={PostPage}/>  
```

- U DRUGOJ KOMPONENTI JE

```jvascript
<Link to={`posts/${id}`}>
    <h3>{title}</h3>
</Link>
```

A KOMPONENTA KOJA SE OTVARA NA ZADATOM PATHU JESTE KOMPONENTA KOJOJ TREBA ODGOVARAJUCI DATA

U MOM PRIMERU TO JE PostPage

## SADA MOGU POSTAVITI PITANJE: KAKO DA KOMPONENTA PostPage KONZUMIRA PODATKE, KOJE ODGOVARAJU ONOM POST-U, ZA KOJI JE KORISNIK PRISTISNUO LINK?

ZASTO TO PITAM?

RECI CU KOJE SU MI MOGUCNOSTI

**PROPSI NE DOLAZE U OBZIR NARAVNO**, A AKO POGLEDAM MOJ APP, MOGU VIDETI I ZASTO (ALI OVO NIJE NI BITNO, JER SAM TAKAV PRINCIP DAVNO NAPUSTIO) (IAKO SE ONI MOGU PROSLEDITI KROZ Route COMPONENT OVAKO)

AKO ZELIM DA UPOTREBLJAVAM PROPS-E (OVO GOVORIM INACE), TADA *NE BIH KORISTIO component ATRIBUT*, [VEC BIH KORISTIO render ATRIBUT](https://reacttraining.com/react-router/web/api/Route/render-func), KOJEM SE PROSLEDJUJE CALLABCK NA SLEDECI NACIN

```javascript
// ALI OPET OVDE NEMA KORELACIJE IZMEDJU KLIKNUTOG LINKA I ID-JA DOKUMENTA, KOI BI ODGOVARAO POST-U
<Route exact path="/posts/:id" render={routerProps => <PostPage id={id} />}/> 

// DAKLE OVO NE MOZE

// NA OVAJ NACIN BIH JEDINO MOGAO DEODELITI NEKE PROPSE, KOJI BI BILI ZAJEDNICKI ZA SVAKI POST

```

[SEM AKO routerProps](https://reacttraining.com/react-router/web/api/Route/route-props) NE KRIJU NEKU INFORMACIJU O PATHU (TO GOVORIM JER IZ PATH-A, KOJI JE U ADRESS BAR-U, JASNO SE VIDI POST ID, KAO NJEGOV DEO (posts/idNekogPosta))

**I OVO JE ISTINA, TAKO DA BIH OVO POTPUNO BIO VALIDAN NACIN UPOTREBE**

POGLEDAJ OVO:

```javascript
<Route path="/user/:username" component={User} />;

// All route props (match, location and history) are available to User
function User(props) {
  return <h1>Hello {props.match.params.username}!</h1>;
}
```

**DAKLE OVA JPRINCIP JE POTOPUNO VALIDAN I JA MOGU DA GA UPOTREBIM U MOM APP, AL ISTEVE KINNEY TO NIJE URADIO, JER ON ZELI DA KORISTI NESTO STO SE ZOVE 'HIGHER ORDER COMPONENTS'**

## ONO STO JE KINNEY ISKORISTIO JESTE FUNKCIJA withRouter, KOJU JE UVEZAO IZ 'react-router-dom'

[OVA FUNKCIJA](https://reacttraining.com/react-router/web/api/withRouter) USTVARI JESTE **COMPONENT FACTORY FUNKCIJA** (ODNOSNO TA FUNKCIJA PREDTAVLJA **'HIGHER ORDER COMPONENT'**)

JA CU ISKORISTITI OVU HIGHER ORDER COMPONENTU, ALI KADA BUDEM RADIO JOS NESTO U MOM PRIMERU, JA CU TAKODJE, KREIRATI JEDNU HIGHER ORDER COMPONENT-U FROM SCRATCH, TAKO DA CU NAUCITI, KAKO SE ONE PRAVE

## JA CU USTVARI PostPage DODADATI, KAO ARGUMENT, POMENUTOJ withRouter FUNKCIJI; A ONO STO CE IZ TOGA PROIZICI, JESTE NOVA KOMPONENTA KOJA CE (ODNOSNO, NJENA INSTANCA) IMATI TU MOGUCNOST DA PRISTUPI, UPRAVO PATH-U NA KOJEM JE PAGE, U KOJEM SU RENDERED ELEMENTI KOJE REPREZENTUJE

DAKLE POMENUTA FUNKCIJA UZIMA MOJU KOMPONENTU KAO INPUT, ZADAJE JOJ 'DODATNE MOGUCNOSTI, KOJE SU ROUTER RELATED'

ALI BOLJE DA PRVO DEFINISEM, POMENUTO, PA DA ONDA TESTIRAM MOJA APP

```javascript
import React, {Component} from 'react';
import Post from './Post';
import Comments from './Comments';
import {firestore} from '../firebase';
import {collectIdsAndDocs} from '../utility';

// EVO UVESCU TU HIGHER ORDER COMPONENT-U
import {withRouter} from 'react-router-dom';
// SADA POGLEDAJ DOLE export IZJAVU

class PostPage extends Component {

    state = {post: null, comments: []}

    render(){

        return <div>Post page!</div>;

    }

}

export default withRouter(PostPage);      // KAO STO VIDIS IZVOZIM ONU KOMPONENTU,
                                          // KOJA CE BITI OUTPUTED, IZ IZVRSENJA
                                          // HIGHER ORDER KOMPONENTE

// I REKAO SAM DA CE OUTPUTED KOMPONENTA U SEBI IMATI INFORMACIJA O PATH-U

// TO MI JE NAJVAZNIJE

// !!!!! RECI CU ONO STO JA PREDPOSTAVLJAM

// PRILIKOM INSTATICIZIRANJA NOVE KOMPONENTE NJOJ CE (ODNOSNO NJENIM PROPSIMA) TAKO RECI BITI DODATO ONAJ INFO IZ PATH-A
// I TO MI NA PRIMER DAJE MOGUCNOST DA KORISTIM, ONO STO JE DODATO, UPRAVO KADA JE NOVA KOMPONENTA MOUNTED
```

## NAIME, JA SADA MOGU U LIFECYCLE METODAMA, MOJE ORIGINALNE KOMPONENTE (ONE KOJA JE ARGUMENT HIGER ORDER KOMPONENTE) DEFINISATI KORISCENJE TIH STVARI (IZ PROPSA), ODNOSNO STVARI KOJE CE BITI PRIDODATE PROPSIMA KOMPONENTE, KOJA CE PROIZICI IZ POZIVANJA, POMENUTE withRouter() FUNKCIJE

U PITANJU JE NEKOLIKO NOVIH PROPS-A

HAJDE DA DEFINISEM DA SE ONI STAMPAJU

```javascript
import React, {Component} from 'react';
import Post from './Post';
import Comments from './Comments';
import {firestore} from '../firebase';
import {collectIdsAndDocs} from '../utility';

import {withRouter} from 'react-router-dom';


class PostPage extends Component {

    state = {post: null, comments: []}

    render(){

      // EVO, OVDE MOGU DA UPOTREBIM TE NOVE PROPSE

      // U PITANJU SU         match                history              location

        const {match, history, location} = this.props;
        // STAMPACU IH
        console.log({match, history});

        return <div>Post page!</div>;

    }

}

export default withRouter(PostPage);

// TREBA DA TI BUDE JASNO DA SI DEFINISAO UPOTREBLJAVANJE POMENUTIH STVARI
// A DA SI KOJIM SLUCAJEM IZVEZAO TVOJU ORIGINALNU KOMPONENTU
// TI BI IMAO ERROR, JER BI SE INSTATICIZIRALA KOMPONENTA I INICIJALIZOVAO RENDERING U REACT DOM
// POZIVOM render METODE U KOJOJ SI TI UPOTREBIO STVARI KOJE NE BI POSTOJALE

// ALI KAO STO REKOH TI NOVI PROPSI SU DEO KOMPONENTE, KOJA PROIZILAZI IZ withRouter() IZVRSENJA
```

## SADA KADA BUDEM KLIKNUO NA LINK KOJI JE UJEDNO I NASLOV BILO KOJEG POSTA; NOVI PATH CE BITI ADDED U ADDRESS BAR-U, A NA STRANICI CE BITI RENDERED ONO STO REPREZENTUJE PostPage KOMPONENTA

AKO SE SECAM, MOJ PATH, PRI NJEGOVOM ZADAVANJU JE IMAO ONAJ PROMENLJIVI DEO, ONDNOSNO VARIJABLU

- '/posts/**:id**'  (*OVO SAM ZADAO KAO VREDNSOT path ATRIBUTU `<Router/>` ELEMENTA*) (Application KOMPONENTA)

E PA JA UPRAVO ZELIM ONO STO CE TOJ VARIJABLI BITI PROSLEDJENO KADA KORISNIK KLIKNE NA LINK POSTA (NASLOV) (*TAJ LINK REPREZENTUJE NARAVNO Link ROUTER ELEMENT, CIJEM JSX ELEMENTU SAM ZADAO OVAKAV PATH (ODNOSNO ONO STO JE VREDNSOT to ATRIBUTA)*)

- '/posts/${**postId**}' (*NARAVNO AKO SE SECAS Post KOMPONENTE, TAMO SAM ZADAO DA SE SVAKOM POST-U PROSLEDI, ODGOVARAJUCI ID DOKUMENTA IS FIRESTORE 'posts' KOLEKCIJE*)

TO ZNACI DA CE U KONACNICI, OVAJ URL KOJI SE ZADAJE LINKU IZGLEDA NEKAKO OVAKO: *'/posts/ASDasDFfsdghhGRHj*

**EA PA NA SLEDECI NACIN MOGU PRISTUPITI, POMENUTOJ PROSLEDJENOJ VREDNOSTI**

src/components/PostPage.jsx

```javascript
import React, {Component} from 'react';
import Post from './Post';
import Comments from './Comments';
import {firestore} from '../firebase';
import {collectIdsAndDocs} from '../utility';

import {withRouter} from 'react-router-dom';


class PostPage extends Component {

    state = {post: null, comments: []}

    render(){

        // MENI USTVARI SAM OTREBA, POMENUTI            match          PROPS (U PITANJU JE OBJEKAT)
        // I ONO STA SE NALAZI KAO VREDNOST         params             PROPERTIAJA TOG OBJEKTA

        // I KADA PRISTUPIM ONOME (IMENU ONE VARIJABLE) STO SAM ZADAO ZA path ATRIBUT <Router/> ELEMENTA
        //                         A U PITANJU JE BILO      path='posts/:id'        (DAKLE          id)

        // USTVARI MOGU PRISTUPITI PROSLEDJENOJ VREDNOSTI

        const {match, history, location} = this.props;

        // EVO STAMPACU JE
        //************************
        console.log(match.params.id);       //      -->         ASDasDFfsdghhGRHj
        //************************

        return <div>Post page!</div>;

    }

}

export default withRouter(PostPage);
```

## UPRAVO IZ PREDHODNOG PRIMERA VIDIM KAKO SU MOCNE VARIJABLE (MOGU IH ZADATI KOLIKO HOCU U URL-U), KOJE SE ZADAJU U KAO DEO VREDNOSTI path PROPERTIJA REACT ELEMENT, KOJEG REPREZENTUJE Router KOMPONENTA REACT ROUTER DOM-A

## :steam_locomotive::steam_locomotive::steam_locomotive::steam_locomotive: SADA MOGU KORISTITI, PRISTUPLJENOM ID-JU DOKUMENTA, KAKO BI MOGAO FETCH-OVATI POST FROM FIREBASE :steam_locomotive::steam_locomotive::steam_locomotive::steam_locomotive:

## STA CU URADITI SA ID-JEM POST-A, KOJI MI JE SADA DOSTUPAN, NA POMENUTOM PATH-U, I U KOMPONENTE, KOJA REPREZENTUJE DEO ONOGA STO BIVA RENDERED NA TOM PATH-U

- GRABB-OVACU POMENUTI *match.params.id*

- HOOK-OVACU SE IN FIREBASE

- SUBSCRIBEVACU SE NA RELATED DOKUMENT

- TAKODJE GETT-OVATI comments TOG DOKUMENTA

- TAKODJE SE SUBSCRIBOVATI NA comments DOCUMENT

- I HOLD ON TO THE REFERENCES, KAKO BIH MOGAO DEFINISATI ADDING KOMENTARA NA ISTOM MESTU

I SVE JE TO DETERMINED BY THE URL, KOJI CE MI RECI NA STA SE TREBAM SUBSCRIBE-OVATI, I UNSUBSCRIBE-OVATI

## PRVO CU KREIRATI, NEKOLIKO HELPER FUNKCIJA

src/components/PostPage.jsx

```javascript
import React, {Component} from 'react';
import Post from './Post';
import Comments from './Comments';
import {firestore} from '../firebase';
import {collectIdsAndDocs} from '../utility';

import {withRouter} from 'react-router-dom';


class PostPage extends Component {

    state = {post: null, comments: []}

    // TO CE BITI SLEDECI GETER ID-JA, RELATED POST DOCUMENTA
    get postId(){
        return this.props.match.params.id;  // OVO SAM URADIO JER NECU OVO STALNO DA KUCAM
    }

    // NAPRAVICU I GETTER, KOJI TREBA DA GETT-UJE          DocumentReference       INSTANCU, POMENUTOG DOCUMENTA

    get postRef(){
        return firestore.doc(`posts/${this.postId}`);
    }

    render(){

        const {match, history, location} = this.props;

        console.log(match.params.id);

        return <div>Post page!</div>;

    }

}

export default withRouter(PostPage);
```