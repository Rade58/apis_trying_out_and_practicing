# LOADOVANJE HEAVY MODULA (MOZDA CELE BIBLIOTEKE ASINHRONO)

DAKLE, SADA CU UPOTREBITI LAZY LOADING, ODNOSNO STATICKI CODE SPLITTING, KAKO BI ASINHRONO LOAD-OVAO CEO LIBRARY

INSTALIRACU CEO LIBRARY ZA MO JPROJEKAT

NEKA TO BUDE [GSAP](https://greensock.com) (GREEN SOCK), **KOJI DELUJE MOCNO**

PAKET LIBRARY-JA JE [OVDE](https://www.npmjs.com/package/gsap)

[KORISCENJE S npm-OM WEBPACK-OM](https://greensock.com/docs/NPMUsage)

GLOABALO GA INSTALIRAM

- yarn add gsap

INSTLACIJA CE TECI MALO DUZE

UCI CU U ENTRY POINT (MOJ index.js FAJL) I IMPORT-OVACU, NESTO IZ POMENUTOG LIBRARY-JA

**index.js** FAJL:

```javascript
// MOGU ISPROBATI, OVAJ TIM import SINTAKSE
import * as GSAP from "gsap";

// I NE MORAM DA GA KORISTIM DALJE

```

MOGU SADA POKRENUTI DEVELOPMENT SCRIPT

- yarn dev

**MOJ BUNDLE CE IMATI PREKO 800kB** (CISTO POREDJEDNJA RADI, ON BI BEZ, POMENUTE BIBLIOTEKE BIO TEZAK OKO 400kB)

MOGU OPET DA, U CHROME DEV TOOLS-U PROVERIM, KOJI JE COVERAGE

- Ctrl + Shift + P

- Show Coverage

- PRITISKAM :arrow_right_hook: (on hover bice prikazan tooltip: *Start instrumenting coverage and reload page*)

**OVAJ TOOL CE PRIKAZATI DA JE SADA OKO 400kB BUNDLE-A, UNUSED** (DOBRO NESTO OD TOG-A, UNUSED CODE-A ,SE ODNOSI NA CODE WEBPACK-OVOG CACHE-A, KOJI JOS NIJE EXECUTED, ALI U SUSTINI, BIBLIOTEKA JE TAKO KOJA JE NEISKORISCENA, A NAQLAZI SE U BUNDLE-U)

## DA SAM NA PRIMER KORISTIO "eval" SOURCE MAP, MOGAO SAM VIDETI DATA COVERAGE, SVAKOG OD MODULA

[source maps options](https://webpack.js.org/configuration/devtool/#devtool) (devtool PROPERTI)

REDEFINISEM DEVELOPMENT KONFIGURACIJU

**webpac.development.js** U **build-utils** FOLDER-U

```javascript
module.exports = () => ({
    devtool: "eval",        // DAKLE, KORISTIM eval
    output: {
        filename: 'bundle.js'
    },
    module: {
        rules: [
            {test: /.css$/, use: ["style-loader", "css-loader"]}
        ]
    }
})
```

MOGU SADA DA STARTUJEM DEVELOPMENT SCRIPT

I U CHROME DEV TOOLS-U PROVERIM DATA COVERAGE

**ONO STO CU VIDETI JESU MOJI MODULI I NJIHOV COVERAGE**

**ALI VIDECU I MODULE, OD KOJE JE CELE BIBLIOTEKA GSAP**

- TAMO VIDIM OGROMNU NEUPOTREBLJENOST CODE-A

## HAJDE DA RESIM OVO, STATICKIM CODE SPLITTING-OM

ODNOSNO LAZY LOADING-OM

RECIM ODA MI TA BIBLIOTEKA NE TREBA SVE DOK NE PRITISNEM NEK ODUGME

```javascript
const getGsap = () => import("gsap");

neko_dugme.addEventListener('click', function(ev){
    // CODE IZPROSLOSTI KOJ IJE TAKODJE KORISTIO LAZY LOADING
    // ....
    
    // DEFINISEM DA SE BIBLIOTEKA UCITA DINAMICKI
    getGsap();
})

```

SADA KADA VIDIM COVERAGE, MOGU VIDETI DA JE MOJ BUNDLE, SAMO OKO 5% NEISKORISCEN

A KADA PRITISNEM DUGME, DESICE SE I NETWORK REQUEST ZA NOVIM BUNDLE-OM (UZ SAV IMPERATIV LAZY LOADING-A, KOJI SU OBJASNJENI U PROSLIM md FAJLOVIMA)

POSTO SAM U POMENUTOM PRIMERU OD RANIJE VEC KORISTIO LAZY LOADING IMACU SADA TRI BUNDLE FAJLA

- JEDAN KOJI JE INICIJALNO BIO TU

- DVA KOJA SU TU STATICKIM CODE SPLITTING-OM (JEDAN OD NJIH HOUSE-UJE CODE CELE BIBLIOTEKE)

NARAVNO BIBLIOTEKA JE I DALJE NESKORISCENA, JER NISAM DEFINISAO NIKAKV CODE, KOJI KORISTI, POMENUTU GSAP BIBLIOTEKU