# IMPLEMENTING PRESETS

SVA PRICA O PRESET-IMACE BITI OBMOTANA OKO SLEDECEG PITANJA: 'ZASTO UOPSTE DODAVATI PRESETS SISTEM?'

KADA JE LARKIN POCEO DA KORISTI WEBPACK, JEDNA STVAR KOJA GA JE FRUSTRIRALA OGLEDALA SE U TOME DA BI ON NESTO DODAO, KAKO BI VIDEO DA LI FUNKCIONISE, A ONDA BI ZABORAVIO DA JE UKLONI I TO BI IRREVOKABLY BREAK-OVALO STVARI, I ON BI SE ONDA PITAO STA JE TO URADIO; I TO NIJE DOBRO

KASNIJE MNOGE OVAKVE STVARI SU POPRAVLJENE SA DEFINISANJEM DEFAULT-OVA

IDEJA O PRESET-OVIMA SE OGLEDA U TOME DA CE POSTOJATI MNOGO VISE NEGO SAMO dev I prod

NAIME, POSTOJACE RAZLICITI SCENARIOI, KOJI CE SE OGLEDATI U TOME DA ZELI MDA ISPROBAM NOVI FEATURE; ILI ZELIM DA ANALIZIRAM BUILD, JUST THIS ONE TIME (NESTO AT HOOK, ILI NESTO STO MOJ CI RUNS), ALI NE ZELIM DA BUDE SHIPPED U MOJU PROD CONFIG, JER NIJE RELEVANTNO, SVAKI PUT KADA JE RUNN-UJEM

I TU NA SCENU STUPAJU PRESETS (LARKIN IH NEKADA ZOVE ADDONS ,ALI MOGU IH ZVATI KAKO HOCU)

## CODE KOJI CU PISATI

NAIME, JA CU DEFINISATI FUNKCIJU, KOJA UZIMA env (env OBJEKAT, ODNOSNO ENVIROMENT VARIJABLA, PROSLEDJENA KADA SAM RUN-OVAO SCRIPT); A UZIMA GA OD MAIN CONFIGURACIJE

U OBIMU TE FUNKCIJE ONDA RADIM SLEDECE

- PULL-UJEM PRESET-OVE OUT (presets PROPERTI SKLADISTI (REFERENCIRA) NIZ)

- SLEDECA SINTAKSA JE FLATTENING NIZA (ZATO STO JE MOGUCE DA SE NADJE JEDAN PRESET U ARRAY-U, ILI DA SE U POMENUTOM ARRAY-U, OPET NADJE ARRAY PRESET-OVA (NE ZNAM ZASTO JE TAKO (SAZNACU NAKNADNO)?))

MENI JE POTREBAN DAKLE JEDAN NIZ, U KOJEM JE SVAKI CLAN, JEDAN PRESET, A CLAN NE SME BITI PODNIZ, I IZ TOG RAZLOGA PRAVIM NOVI NIZ, U KOJEM TO NECE BITI

ZA POMENUTO MOGU UPOTREBITI SPREAD SINTAKSU U KOMBINACIJI SA Array.prototype.concat METODOM, ZATO STO ARGUMENTI concat METODE MOGU BITI I NIZOVI, A I PRIMITIVNE VREDNOSTI, A KAO POVRATNA VREDNOST, BICE JEDAN NIZ KOJI NEMA PODNIZOVA

ZA OVO SAM MOGAO KORISTITI I Array.prototype.flat METODU (MEDJUTIM ONA JE EXPERIMANTAL)

- ZATIM JE POTREBNO PRISTUPITI SVAKOM PRISET-U (U POMENUTOM NIZU, UZ POMOC map METODE NIZOVOG PROTOTIPA)

TU CU DEFINISATI DA SE REQUIRE-UJE (require CommonJS-A) (OPET PONAVLJAM, ZAPAMTI DA SU DRUGE KONFIGURACIJE, USTVARI FUNKCIJE, KOJE JE POTREBNO POZVATI DA BI RETURN-OVALE OBJEKAT KONFIGURACIJE (ARGUMENT JE UVEK env OBJEKAT)), KONFIGURACIJA (IZ FOLDERA presets, KOJI CU NARAVNO IMATI KREIRANOG SA SVIM TIM PRESET-OVIMA), U ODNOSU NA IME PRESETA (TAKO JE, NJEMU PRISTUPAM U CALLBACKU map METODE)

- NOVI NIZ KREIRAN UZ POMOC map METODE, SASTOJACE SE OD KONFIGURACIJSKIH OBJEKATA

- POTREBNO JE DA SVE TE OBJEKTE, CLANOVE POMENUTOG NIZA ISKORISTIM KAO ARGUMENTE METODE "webpack-merge"

(ZNAS DA JE POMENUTA METODA USTVARI METODA POPUT Object.assign, ALI SAMO ZA KONFIGURACIJSKE OBJEKTE)

MEDJUTIM, POSTO NE ZELIM DA OVERRIDE-UJEM NI JEDAN PRESET, PRVI ARGUMET MERGING METODE BICE PRAZAN OBJEKAT

FAJL CU NAZVATI **loadPresets.js**

```javascript
const webpackMerge = require("webpack-merge");

module.exports = env => {
    const {presets} = env;
    const presetsArrayFlatten = [].concat(...[presets]);
    const configsArray = presetsArrayFlatten.map(
        presetName => require(`./presets/webpack.${presetName}`)(env);
    );

    return webpackMerge({}, ...configsArray);
}
```

**OVO JE SAMO KONVENCIJA, KOJA MI MOZE POMOCI DA UVIDIM: "Hey I can *compose* these, as many ways as I want to"**

## VRACAM SE SADA U, MOJU REGULARNU KONFIGURACIJU, GDE CU SE POSTARATI DA IMPLEMENTIRAM PRESETS