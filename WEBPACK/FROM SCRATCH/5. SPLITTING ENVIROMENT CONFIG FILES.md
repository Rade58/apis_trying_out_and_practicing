# SPLITTING ENVIROMENT CONFIG FILES

RANIJE SAM MOM PROJEKTU DODAO FOLDER, KOJI SAM NAZVAO

- **build-utils** (MOGU GA NAZVATI KAKO HOCU, ALI TAKO JE LOGICN ODA GA ZOVEM) (JER INDIKATIVNO JE DA SE TU STAVLJAJU KOMPILACIJE (BUNDLE-OVI), ODNOSNO TU SE DOGADJA BUILD)

REAKO SAM DA CU U TAJ FOLDER STAVLJATI SUPLEMENTAL, ODNOSNO PARTIAL CONFIGURATION-E, ILI DRUGE UTILITY-JE

## PRIKAZACU STA IMAM DO SADA U MOM CONFING FAJLU, ALI CU PRIKAZATI I package.json CISTO DA GA IMAM TU PRI RUCI

webpack.config.js FAJL:

```javascript
const webpack = require('webpack');
const HtmlWebpackPlugin = require('html-webpack-plugin');

module.exports = ({mode}) => {
    console.log(mode);
    return {
        mode,
        output: {
            filename: 'bundle.js'
        },
        plugins: [
            new HtmlWebpackPlugin(),
            new webpack.ProgressPlugin()
        ]
    }
}
```

package.json FAJL:

```javascript
{
  "name": "rade_webpack",
  "version": "1.0.0",
  "description": "Practicing webpack",
  "main": "index.js",
  "scripts": {
    "webpack": "webpack",
    "webpack-dev-server": "webpack-dev-server",
    "debug": "node --inspect --inspect-brk ./node_modules/webpack/bin/webpack.js",
    "dev": "npm run webpack-dev-server -- --env.mode development --watch",
    "prod": "npm run webpack -- --env.mode production",
    "dev:debug": "npm run debug -- --env.mode development",
    "prod:debug": "npm run debug -- --env.mode production"
  },
  "keywords": [
    "webpack",
    "plugins",
    "configuration"
  ],
  "author": "Rade",
  "license": "ISC",
  "dependencies": {},
  "devDependencies": {
    "html-webpack-plugin": "^3.2.0",
    "webpack": "^4.31.0",
    "webpack-cli": "^3.3.2",
    "webpack-dev-server": "^3.3.1"
  }
}
```

## DA NAPRAVIM REKAPITULACIJU U POGLEDU ONOGA STO ZNAM O ENVIROMENT VARIJABLAMA

KADA U KONZOLI EXECUTE-UJEM SLEDECU KOMANDU:

- npm run dev ILI yarn dev

RUNN-OVACE SE SLEDECI SCRIPT

**"dev": "npm run webpack-dev-server -- --env.mode development --watch"**

TO ZNACI DA CE SE U CONFIG FAJL-U (ODNOSNO FUNKCIJI), PROSLEDITI OBJEKAT, KAO ARGUMENT, I TO OBJEKAT, KOJI IZGLEDA OVAKO

- {mode: "development", .. ... ....}

**POMENUTI OBJEKAT IZMEDJU OSTALIH PROPERTIJA, IMA I ONAJ, KOJI JE PODESEN U STARTTING-OM POMENUTOG SCRIPT-A**

JA SAM OVIM OVERRIDE-OVAO, NEKE DEFAULT VREDNSOTI, SA KOJIMA SE POMENUTA FUNKCIJA EXECUTE-UIJE (TACNIJE mode KOJI JE BIO "production", OVERRIDEN SA "development")

## NEKADA POSTOJI POTREBA ILI ZELJA DA SE DODA, ODNOSNO DA DEFINISEM DA SE LOAD-UJE EXTRA, ODNOSNO DODATNI JAVASCRIPT MODUL, KOJI JE POTREBNO MERGE-OVATI SA, MOJIM BASE SET-OM CONFIGURATION ITEMA

LARKIN TO VOLI DA RADI NA SLEDECI NACIN

```javascript
const webpack = require('webpack');
const HtmlWebpackPlugin = require('html-webpack-plugin');

// DEKLARISEM VARIJABLU, A TA VARIJABLA TREBA DA SKLADISTI FUNKCIJU
// FUNKCIJA TREBA DA RETURN-UJE POZIVANJE FUNKCIJE, KOJA JE PROIZISLA IZ POZIVANJA require METODE
// A ONO STO SE TREBA REQUIRE-OVATI, JESTE MODUL, KOJI BI SE NALAZIO U
//                                                                        build-utils   FOLDERU

// ARGUMENT, KOJI BI SE DODAVAO OVOJ FUNKCIJI, PRI NJENOM POZIVANJU, JESTE VREDNOST mode PROPERTIJA, OBJEKATA, KOJI SE
// PROSLEDI, KADA EXECUTE-UJEM, NEKI OD SCRIPT-OVA U TERMINALU (VREDNSOT, TOG PROPERTIJA, U MOM SLUCAJU
// UVEK JE BILA ILI 'development' IL I'production', DAKLE RADILO SE O ONOME STO JE POTREBNO DEFINISATI KAO
// mode )

const modeConfig = envProp => require(`./build-utils/webpack.${envProp}`)(envProp)

//*****************DAKLE, OVDE TREBA ODMAH UVIDETI, DA require USTVARI RETURN-UJE FUNKCIJU U OVOM SLUCAJU

// NARAVNO, OVU FUNKCIJA TREBA BITI POZVANA SA, VREDNOSCU mode-A
// POVRATNA VREDNOST, OVE FUNKCIJE, TREBA DA BUDE OBJEKAT

// TAJ OBJEKAT JE POTREBNO MERGE-OVATI (KORISCENJEM JEDNE FUNKCIJE, KAOJA JE POPUT Object.assign-a)


module.exports = ({mode}) => {
    console.log(mode);
    return {
        mode,
        output: {
            filename: 'bundle.js'
        },
        plugins: [
            new HtmlWebpackPlugin(),
            new webpack.ProgressPlugin()
        ]
    }
}
```

LARKIN JE JEDNOM PRILIKOM REKAO KAKO **CommonJS CAN BE ABUSED**

**PREDPOSTAVLJAM DA JE OVDE O TOME REC, JER REQUIRE-UJEM ASSET, KOJI JE FUNKCIJA**

**A TA FUNKCIJA, TREBA DA RETURN-UJE OBJEKAT, KOJI JE ISTI ONAJ KONFIGURACIJSKI OBJEKAT (KONFIGURACIJE, KOJU SAM JA NAPISAO)**

POMENUTU FUNKCIJU **modeConfig** CU UPOTREBITI KASNIJE ,A PRE TOGA DA KAZEM JOS NESTO

## OVO JE MOJA PREDPOSTAVKA

KADA ZELIM DA DODAM NEKI NOVI KONFIGURACIJASKI MODUL, POTREBNO JE DA GA WRAPP-UJEM U FUNKCIJU

A FAJL JE POTREBNO DA NAZOVEM TAKO, DA ON IMA I JOS JEDNU EKSTENZIJU

NA PRIMER, SLEDECI FAJL:

- webpack.development.js

OVAJ FAJL, TREBA DA RETURN-UJE FUNKCIJU, CIJA CE POVRATNA VREDNOST BITI NEKA DRUGA KONFIGURACIJA

**ONO STO MI NIJE JASNO JESTE DA LI SE JA BRINEM O TOM WRAPPING-U?**

**PREDPOSTAVLJAM DA JE ODGOVOR: DA**

## PARAMETAR MOJE FUNKCIJE KOJA PRODUCES KONFIGURACIJSKI OBJEKAT

TAJ PARAMETAR, TREBA DA BUDE RESTRUKTUIRAN OBJEKAT, ALI ON TREBA DA IMA I DEFAULT ARGUMENT

KROZ TAKVO DEFINISANJE, JA SAM OBEZBEDIO (ODNOSNO OBZNANIO MOGUCEM KORISNIKU, MOJE KONFIGURACIJE), DA ONAJ KO POSMATRA MOJ CONFIG FILE, IMA BOLJI UVID

**NARAVNO, POMENUTE DEFAULT VREDNOSTI JESU ONE VREDNOSTI, KOJE SU KREATORI WEBPACK-A, VEC OBEZBEDILI, ALI BOLJE JE SINTAKSICKI, VEC PREDSTAVITI OBJASNJENJE STA SE DESAVA, BY PROVIDING DEFAULT PARAMETAR, ODNOSNO DEFAULT ARGUMENT**

```javascript
const webpack = require('webpack');
const HtmlWebpackPlugin = require('html-webpack-plugin');

const modeConfig = envProp => require(`./build-utils/webpack.${envProp}`)(envProp)


// DAKLE PRAMETAR OBJEKAT TREBA DA IMA I presets PROPERTI
// AKO TAJ OBJEKAT NIJE OBEZBEDJEN ON CE BITI PRAZAN NIZ, A TO PO DEFAULT-U I JESTE

// STA SE DEFINISE, POD presets PROPERTIJEM, SAZNACU KASNIJE

module.exports = ({mode, presets} = {mode: "production", presets: []}) => {  // DEFINISAO SAM CE PARAMETAR

    console.log(mode);
    return {
        mode,
        output: {
            filename: 'bundle.js'
        },
        plugins: [
            new HtmlWebpackPlugin(),
            new webpack.ProgressPlugin()
        ]
    }
}
```

DAKLE NA OVAJ NACIN, SA DEFAULT ARGUMENTOM, DEFINISAN JE FALLBACK

AKO RUN-UJEM

- yarn webpack ILI npm run webpack

NECE BITI NISTA PROSLEDJENO, I POMENUTI OBJEKAT, {mode: "production", presets: []} , BICE DEFAULT (ALI TO JE VEC IONAKO DEFAULT, KAKO SAM SAZNAO RANIJE, KOJI SU OBEZBEDILI KREATORI WEBPACK-A)