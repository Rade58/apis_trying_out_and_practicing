# COMPOUND INDEXES

AUTOR WORKSHOPA KAZE DA OVO STALNO KORISTI (FAVORITE FEATURE)

>> REKAO JE DA BI NJERGOV APP DIE-OVAO KADA BI BIO BEZ COMPOUND INDEKSOVA

ONI SU SO FANTASTIC IN MONGO

DAKLE ONI PREDSTAVLJAJU DIFFERENT TYPE INDEKSA

## COMPOUND INDEKS JE INDEKS, ON MORE THAN ONE FIELD

RANIJE SI DODAVAO **unique: *true*** ZA SAMO JEDAN FIELD; *A SADA BI TREBAL ODA DODAVAM INDEKSE ON COMBINATION OF FIELDS, STO JE VEOM VEOMA USEFULL, I TO SU COMPOUND INDEKSI*

## NAJBOLJE DA PRVO PREDSTAVIM METODU, KOJOM SE DEFINISU INDEKSI, PRE NEGO STO VIDIM STA SU TO USTVARI COMPOUND INDEKSI

NE MORAM PISTAI unique: true NA SAMOJ SCHEMA-I, VEC ZA TO MOGU KORITITI METODU

NA TAJ NACIN INDEKSE KEEP-UJEM AT ONE PLACE (*ALI TO JE JEDNA OD STVARI KOJU RADI, OVA METODA JE MNOGO VISE OD TOGA*)

```javascript
const school = new mongoose.Schema({
  name: {
    type: String,
    // unique: true    // DAKLE ZELIS DA name BUDE unique (NE MORAS TO OVDE DEFINISATI)
  },
  openSince: Number,
  students: Number,
  isGreat: Boolean,
  stuff: [{type: String}]
})

// MOZESI I OVAKO ZADAVATI INDEKS

school.index({
  name: 1
}, {unique: true})

// SAVIM TI JE JASNA SINTAKSA       ZA name SI ZADAO DA IMA INDEKS, A JASNO TI JE DA SI TO MOGAO URADITI ZA VISE FIELD-OVA
// SAM O JE POTREBN OZDATI      1     ZA FIELD KOJ IZELIM 

```

## KAKO BI OBJASNIO STA SU TO COMPOUND INDEKSI NAJBOLJE JE DA PREDSTAVIM PROBLEM, KOJI BI ZAHTEVAO NJIHOVO KORISCENJE

AKO POSMATRAM GORNJU schoo lSCHEMA-U I AKO NA PRIMER UVDEM MOGUCNOST DA DOKUMENTI I SCHOOLS KOLEKCIJE IMAJU I FIELD district KOJI BI DEFINISAO DAKLE U KOJOJ OBLASTI JE SKOLA MOGAO BIH DA SGLEDAM SLEDECE PROBLEME

- OBICNO U JEDNOM DISTRICT-U, NE POSTOJE DVE SKOLE SA ISTIM IMENOM; ALI UZMI ZA MOGUCNOST DA SE TO DESI

RESENJE NA OVAKAV PROBLEM BI MOZDA BILO DA school BUDE unique

- A AKO POSMATRAM IZ DISTRIKTOVOG UGLA GLEDANJA, MOGU RECI DA MOGU POSTOJATI VISE SKOLA SA ISTIM IMENOM A DA SU ONE U RAZLICITIM DISTRICTIMA

- U MOM PRIMERU NEKLA DISTRICT FIELD BUDE TOLIKO VAZAN DA ON MORA BITI TYPE, KA ODOKUMENT

HAJDE DA DEFINISEM PRIMER

```javascript
const school = new mongoose.Schema({
  // EVO GA DISTRICT
  district: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'district'
  },
  name: {
    type: String,
  },
  openSince: Number,
  students: Number,
  isGreat: Boolean,
  stuff: [{type: String}]
})

school.index({
  // DODACU OVDE DA I district BUDE UNIQUE
  district: 1,
  //
  name: 1
}, {unique: true})
```

AKO SADA POKUSAM DA SAVE-UJEM:

- school KOJI IMA ISTO IME U ISTOM district-U

DOBICU ERROR

- ALI AKO SAVE-UJEM ISTU SKOLU KOJA POSTOJI U NEKOM DRUGO MDISTRICT-U SVE CE BITI U REDU

## REDOSLED DEFINISANJA U index METODI JE BITAN

- NA PRIMER GORE NE BIH SMEO DA STAVI MPRVO name, PA ONDA district (TO BI 'POREMETILO POREDAK')

## ONO STO SE DESILO U PREDHODNOM PRIMERU JESTE DA JE STVOREN COMPOUND INDEKS GDE JE NA district-U, PRVI DO INDEKSA, A NA name-u DRUGI DEO INDEKSA

JA SAM TUI REKAO

I NEED THE NAME TO EXIST UNDERNEATH THE district

DA SAM STAVIO name FIRST IMAO BIH UNIQUE names

OVO JE MALO KOMPLIKAOVANO ALI NAJBOLJE JE RECI SLEDECE ZA PRIMER I KORISTITI TO U PRAKSI ,ZA OSTALE PRIMERE

*****

```javascript
const school = new mongoose.Schema({
  district: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'district'
  },
  name: {
    type: String,
  },
  openSince: Number,
  students: Number,
  isGreat: Boolean,
  stuff: [{type: String}]
})

school.index({

  district: 1,          // district       JESTE UNIQUE
  
  name: 1               // ALI        name    JE SAM OUNIQUE UNDERNEATH TE DISTRICT

}, {unique: true})
```

*****

I ZATO,  USLUCAJU OVOG PRIMERA MOZE POSTOJATI VISE SKOLA SA ITIM IMENOM PREKO RAZLICITIH DISTRICTA, ALI NE I U JEDNO MDISTRICT-U JER TAMO IMENA SKOLA MORAJU BITI RAZLICITA

## NAROCITO ODRADI VEZBU KOJA SE TICE OVOG POGLOAVLJA

MISLIM DA CU SVE BOLJE RAZUMETI KROZ VEZBU
