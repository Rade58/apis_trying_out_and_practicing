# MODULI

MODULI PREDSTAVLJAJU ENCAPSULATED CODE ("IT'S ITS OWN THING"), KOJI MORAM EKSPLICITNO TRAZITI

ENCAPSULATED JE ZBOG SVEGA ONOGA STO BI MOGLO DA SE MESS WITH THAT CODE, I NIKAD SE NE KACI NA GLOBAL

ONO STO MOGU DOBITI JE SAMO ONO STO SAM ZATRAZIO, ZATO GA JOS ZOVU I STINGY ("SKRT") CODE

AKO GA ZAKACIS NA GLOBAL NASTAJU PROBLEMI, STO MOZES PROBATI KOD BROWSER CODE-A, A PROBLEMI NASTAJU JER IMAS NEKI GLOBAL KOJI SI CHANGE-OVAO I ONO MOZE UTICATI NA CODE DRUGOG MODULA AKO SI I NJEGA ZAKACIO (MOZE DOCI DO SLUCAJNOG COLISION-A) (ZATO OPET NAPOMINJEM DA SE NISTA NE KACI NA GLOBAL) (ODNONO BOLJE JE RECI: "OD MODULA SE NE TREBA PRAVITI GLOBAL KOJI BI BIO TAJ MODUL, JER ON MOZE POKVARITI NESTO DRUGO")

## ONI IZGLEDAJU NA PRIMER OVAKO

```typescript
// DAKLE TO SU SAMO FUNKCIJE

JEDAN FAJL

var module1 = (function(exports, require, module, __filename, __dirname){
    // TVOJ nodejs CODE
    //                      U NEKOM FAJLU
})

DRUGI FAJL

var module2 = (function(exports, require, module, __filename, __dirname){
    // TVOJ nodejs CODE 
    //                      U NEKOM **DRUGOM** FAJLU
})


// DAKLE, JEDNA FUNKCIJE PO JEDNOM FAJL

// **** I FUNKCIJE SU STAVLJENE U ZAGRADE STO ZNACI DA ONE, PREDPOSTAVLJAM
// ***** SIGURNO NAMENJENE DA

// A NESTO CE INJECT-OVATI GORE SPECIFICIRANE GLOBALS

```

AKO ZELIM DA KORISTIM DRUGI MODUL, MORAO BI DA ZATRAZIM I RUNTIME, ODNOSNO ENVIROMENT CE PRONACI TAJ MODUL, KOJ ITRAZIM PO IMENU I DACE MI GA

I DOBICU SAMO ONO STO MI TAJ MODUL DOZVOLJAVA DA DOBIJEM

**DAKLE OKO FUNKCEJU SU STAVLJENE ZAGRADE, STO ZNACE DA SU PLANIRANE ZA LATER INVOKING**

DAKLE CODE JE ENCAPSULATED AND NOTHING CAN TOUCH IT

LJUDI SU 2011 I 2012 STALNO FUNKCIJE STAVLJALI U:

IIFE

BACKBONE I ANGULAR SE NEKAD KORISTIO NA POMENUTI NACIN

*SVE JE NA window-U  ITO JE GROSS, ZATO HAJDE DA KORISTIMNO MODULE KOJI SU USTVARI IIFE*

TAK OSU RODJENI CommonJs, ALI  IAMD MODULE SYSTEMS

A U BROWSERU SADA IMAM I ES6 MODULE SYSTEM (LEGIT SU ALI NE RADE TAKO DOBRO KAO MODULI U NODE-U)

*DAKLE SADA SE TI MODULI LOADUJU SINHRONO ILI ASINHRONO U BROWSER-*

## MOZES DA THROW-UJEN ERROR U `CLI EXECUTABLE-U` (ONDNOSNO  UJAVASCRIPT FAJLU, KOJI CES DA RUNN-UJES SA NODE-OM (TAKAV FAJL JE KAO STO SI GORE I SUGIREISAO, TAKODJE MODUL)) I VIDIS STA CE TI BITI OUTPUT U TERMINALU

*practice/practice.js*

```javascript
throw new Error("ups, ovo je greska");
```

- node practice/practice.js

ONO STA CES MOCI DA VIDIS KAO OUTPUT JESTE SLEDECE:

```typescript
(function (exports, require, module, __filename, __dirname) { throw new Error('uuuups, ovo je greska')

 ^

Error: uuuups, ovo je greska
    at Object.<anonymous> (C:\Users\Documents\vezbe_za_web_aplikacije\NODEJS blah\practice\practice.js:1:69)
    at Module._compile (internal/modules/cjs/loader.js:701:30)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:712:10)
    at Module.load (internal/modules/cjs/loader.js:600:32)
    at tryModuleLoad (internal/modules/cjs/loader.js:539:12)
    at Function.Module._load (internal/modules/cjs/loader.js:531:3)
    at Function.Module.runMain (internal/modules/cjs/loader.js:754:12)
    at startup (internal/bootstrap/node.js:283:19)
    at bootstrapNodeJSCore (internal/bootstrap/node.js:622:3)
```

KAO STO VIDIS GORE, CODE JE NCAPSULATED U POMENUTU FUNKCIJU KOJA IMA PARAMETRE, KOJI PREDSTAVLJAJU, POMENUTE GLOBALS

TO NISAM JA NAPISAO, VEC JE NODE TO TU STAVIO, UMESTO MENE DA JA NE BI MORAO DA RNCAPSULAT-UJEM, MOJ CODE U IIFE

**DAKLE KADA PISES SVOJ NODEJS CODE, U BILO KOJEM FAJLU, IMAJ NA UMU DA NODE, TAJ CODE CELOG FAJLA WRAPP-OVATI U IIFE I IZVRSITI I PRITOM, TU SU PROSLEDJENE GLOBALS, KOJE MOZES DA KORISTIS U SVOM CODE-U** (UPRAVO BAS KAO STO VIDIS GORE U TERMINALU)

TVOJ GORNJI CODE JE BROKEN I TI SI VIDEO CODE CELOG FAJLA (I VIDEO SI KAK OJE WRAPPED); A NARAVNO, KADA NEMAS ERROR-A, Nodejs CE IZVRSITI TVOJ FAJL (ODNOSNO SDA KAD ZNAS OD CEGA SE SASTOJI MOZES GA STRAIGHT UP ZVATI MODULOM) I NODE CE ONDA EXIT-OVATI (TI TADA NE BI VIDEO )

TU NECAPSULIRAJUCU FUNKCIJU TI NE BI VIDEO NI KADA BI CODE RUN-OVAO U INTERACTIVE REPL-U

## AKO POSMATRAS POMENUTU FUNKCIJU KOJA BIVA POZVANA KAO IIFE, VIDECES U NJENIM PARAMETRIAM SAO NEKE GLOBALS

TO JE ZATO STO SE PRI SVAKOM IZVRSENJU PRAVE NOVE INSTANCE ZA

- exports, require, module, __filename, __dirname

>>>> __dirname is different depending on what directory you're in. __filename is different depending on what file you're in. module is different, requires are different, exports

SVAKA DRUGA GLOBALS, JE ZAKACENA ZA GLOBALS, KOJI SE ZOVE global

TO JE ZATO STO SE ONE NE MENJAJU

## Nodejs POLAKO USVAJ ECMA SCRIPT MODULE SINTAKSU

[OVO JE POPUT caniuse, ALI ZA Nodejs](https://node.green/) (**PODRAZNAOST BILO KAKVE JAVASCRIPT SINTAKSE MOGU LOOK-OVATI OVDE, I TO PO RELEASED VERZIJAMA NODE-A**)

TU MOGU PROVERITI PODRZANOST ESM-A (MISLIM DA TAMO IPAK NEMA NICEG O MODULIMA, ALI IMA O DRUGOJ SINTAKSI)

[PROCITAJ OVO](https://nodejs.org/api/esm.html#esm_ecmascript_modules) (PO OVOME ESM U NODE-U JE U EKSPERIMENTALNOJ FAZI)

NARAVNO VERZIJU SVOG nodejs PROVERAVAS OVAKO: (TO SAM I POMENUO):

- node -v ILI node --version

## JA NA PRIMER KORISTIM ES MODULE, KADA PISEM TypeScript, ALI ONI SE TRANSPILE-UJU U commonJs MODULE JER SAM TAKO PODESIO

[TypeScript](https://github.com/Rade58/apis_trying_out_and_practicing/blob/master/Node.js/DODATNE%20VAZNE%20STVARI/TYPESCRIPT.md)

## NE KORISTI AMD MODULE

SLABO IH KO BILO GDE KORISTI, ALI CISTO DA ZNAS NESTO ZBOG CEGA MOZE NASTATO CONFUSION

AMD KORISTI RequireJs MODULE SINTAKSU (**ZAPAMTI DA OVO NEMA VEZE SA *require* FUNKCIJOM, KOJA SE KORISTI KAO FEATURE CommonJs MODULE-A**)

>> NE BRKAJ CommonJs I RequireJs

GOOGLE JEDINI KORISTI AMD MODULE I ONO RADE NESTO SJAJNO SA NJIMA (RADE OPTIMIZATION I TO VEOMA VEOMA DOBRU OPTIMIZACIJU) (KORISTE GA KAO BUILD TOOL, I NE WRITE-UJU)

POSTOJE I MNOGO DRUGIH MODUL SINTAKSI ALI ONI DON'T MATTER

STO CE SE NA KRAJU DESITI I SA CommonJs, JER CE GA ZAMENITI ESM, KOJI JE STANDARD

## SUMIRANJE

MODULI SU JEDINI NACIN KOJIM MOGU SHARE-OVATI CODE

MODULE SYSTEM JE REQUIRED SISTEM (NEMA NI JEDNOG MOGUCEG NACINA DA SE KORISTI JEDAN FAJL INSIDE ANOTEHER FYLE, SEM KORISCENJA CommonJs MODULE SINTAKSE)

A MOZES DA KORISTIS TRANSPILER AKO HOCES DA PISES ESM