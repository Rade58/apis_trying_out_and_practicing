# HTTP HEADERS I COOKIES

DAKLE DA POCNEM SA BREAKING DOWN-OM

ZAPOČNEMO SA HEADER-IMA (ZAGLAVIMA)

## ŠTA JE HEADER? ILI ŠTA MISLITE O TOME ŠTA JE HEADER I ŠTA ON RADI?

NEKI OD ODGOVORA FRO MTOP OF MY MIND

- DAJE NEKE METAPODATKE REQUEST-U ILI RESPONSE-U

DA, REKLI SMO DA SE PACKETS SASTOJE OD PODATAKA I ZATIM METAPODATAKA

DIO TIH META PODATAKA JE HEADER, A HEADER JE NEŠTO ZAISTA, STVARNO ZANIMLJIVO ŠTO SVI VEROVATNO KORISTIMO U NEKOM TRENUTKU, ALI NE RAZMIŠLJAMO O ONOME ŠTO RADI. A SJAJNA STVAR KOD OVIH METAPODATAKA JE ŠTO MOŽE REĆI PUNO O TOME OTKUD JE REQUEST DOŠAO BESIDES SAMOG IP-A, ZATIM GOVORI KAKVU VRSTU ENCODING-A IMA, KAKAV CONTENT IMA

ZAPRAVO HEADER IMA TOLIKO INFORMACIJA DA MOŽEMO DA PACK-UJEMO I UNLOAD-UJEMO

I MOŽETE RAZUMETI KAKO SE TAJ REQUEST FORMIRAN I ODAKLE DOLAZI, I MOŽEMO DA ATTACH-UJEMO INFORMACIJE ALL ALONG THE PATH. U STVARI, MOGU DA AYYACH-UJEM HEADERS-E ILI NEŠTO ŠTO ĆE Nginx PROČITATI, SAMO ZA Nginx; IT SHIPS IT, I ONDA PRELAZI NA EXPRESS, ONDA ĆE EXPRESS PROČITATI ZA NJEGA NAMENJENE HEADERS-E, PASS THAT DATA TO SOMETHING ELSE, AND IT STRIPS OUT ANOTHER HEADER

DAKLE, ALONG THE WAY MOZEMO DODAVATI INFORMACIJE ILI ODUZIMATI INFORMACIJE, ZA TO SU HEADERS-I ZAISTA DOBRI

METAFORA KOVERTE:

ONI SU POPUT NATPISA NA SPOLJNOJ STRANI KOVERTE, IMAS PACKETS AND CONTENT, A ZATIM HEADER DEO KOJI MOŽETE DA PREGLEDATE, A DA NE MORATE DA GLEDATE CONTENT

UPRAVO JE TO, SVE SU TO INFORMACIJE O TOME GDE INFORMACIJA IDE, ODAKLE JE, KAKAV ENCODING KORISTI, KAKV ENCODING IS ACCEPTING

A NA OSNOVU TOGA AKO JE REQUEST, TAKO DA NEŠTO IDE PREMA SERVERU ILI AKO JE RESPONSE TAKO DA NEŠTO DOLAZI IZ SERVERA, MENJAJU SE NAUMI KAKVE USTVARI HEADERSE TRAŽIMO, KAKVE ĆEMO HEADERS-E WE ARE GOING TO SET

## OVDE SAM HIGHLIGHT-OVAO NEKE OD UOBIČAJENIH HEADERS-A

```linux
GET / HTTP/1.1
Host: raedal.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36
Accept: text/html
Accept-Encoding: gzip, br
Accept-Language: en,en-US
```

### Host HEADER

- HEADER **Host**A KOJE VEROVATNO POZNAJETE, ONO GOVORI REQUEST-U GDE IDE I GDE JE DESTINATION. **Host** JE ZAISTA ZANIMLJIV JER JE DEO TOGA ŠTO Nginx ČITA KAKO BI ROUTE-OVAO REQUEST NA NJIHOV CORRECT SERVER

SEĆATE SE RANIJE KAKO SMO RAZGOVARALI O VIRTUELNIM **Host**-OVIMA, KAKO MOGU DA IMAM VIŠE SERVERA?

DEO NAČINA NA KOJI Nginx ODREĐUJE GDE POKUŠAVA DA IDE JE ČITANJE HEADER-A

I MISLIM DA SU HEADER ZAISTA, STVARNO MOĆNA I POTCENJENA, VEROVATNO NE RAZMIŠLJAMO TOLIKO O TOME KAKO SE TI PODACI FORMIRAJU I ZA ŠTA SE KORISTE. ALI U OVOM SLUČAJU, Nginx TO ČITA, A EXPRESS NE MARI ZA TO

ZAPRAVO, MOGU IZVADITI **Host** HEADER, I DALJE BI RADILO, ALI NAIŠLI BISTE NA NEKE PROBLEME

FUNNY ENOUGH, MOGU DA ZAHTEVAM PROXY

SEĆATE SE ŠTA JE PROKI? DEFINISALI SMO JE RANIJE.

*KADA IMATE SERVER KOJI PREDSTAVLJA VIŠE RAZLIČITIH ENPOINTS BEHIND HIM, ON SE REROUT-UJE I REDIRECT-UJE, A U OVOM SLUČAJU REVERSE PROXY* (OVO BA SI NE RAZUMEM)

SMEŠNO, POSTOJE ODREĐENI HEADERSI KOJA KLIJENT NE MOŽE MODIFIKOVATI, A **Host** HEADER JE JEDAN OD NJIH. NE MOGU DA LAŽEM ODAKLE JE STIGAO MOJ ZAHTEV, PREGLEDAČI TO UGLAVNOM NE DOZVOLJAVAJU. DAKLE, AKO IMATE SERVICE WORKER-A I POKUŠAVATE DA GA UPOTRIJEBITE KAO POSREDNIKA

*****

digresija:

SERVICE WORKER

PERSISTANT WEB WORKER KOJI RADI U ZASEBNON THREAD-U, A KADA SE TAB ZATVORI, I DALJE SE MOŽE POKRETATI U POZADINI. TO JE NAČIN PRESRETANJA NETWORK REQUEST-OVA, U SUŠTINI, MOŽE DA RADI I DRUGE STVARI.

*****

EARLY ON JEM JE POKUSAVA DA STVORIM PROXY U KLIJENTU, TAKO DA NA OSNOVU ONOGA ŠTO ZAHTEV POKUŠAVA DA URADI PROKSI NA RAZLIČITIM SERVERIMA.

OTKRIO JE DA TO NE MOŽETE UČINITI JER SE NE MOGU MODIFIKOVATI HEADER **Host**, NE MOGU DA IZMENIM GDE TAJ PACKETS TREBA DA ODE, NAKON ŠTO JE REQUEST GONE IN FLIGHT

### SLEDEĆI HEADER JE User-Agent

ŠTA RADI User-Agent?

OBEĆAVAM VAM DA AKO SI WEB DEVELOPER, VEĆ SI ČUO FRAZU, ŠTA JE HEADER User-Agent?

- HEADER BROWSERA, OPŠTE INFORMACIJE O NJEMU

- KAKAV RAČUNAR POSEDUJETE, TAKVE STVARI.

DA, DA LI SE IKADA PITATE ZAŠTO TAKO IZGLEDA UserAgent HEADER?

```linux
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36
```

OVAJ ČUDAN MISHMASH STVARI?

DOLAZI IZ RANIH DANA KADA BROWSER-A NIJE BILO PUNO, POSTOJAO JE JEDAN PREGLEDAČ KOJI JE DOBRO PODRŽAN, A TO JE INTERNET EXPLORER, I TO JE BIO CUTTING EDGE. 

OVO GORE BROJEVI, PART OF IT IS VERSIONING

RAZLOG ZAŠTO IZGLEDA KAO ALPHABET SUPH RAZLIČITIH TIPOVE: "HEY HTML, KOJU NISMO KORISTILI DUGO, DUGO KAO GECKO, STARI ENGINE. TO JE ZATO ŠTO SU BROWSERI BILI, HEJ, JA SAM MODERAN ENGINE, ALI NISAM INTERNET EXPLORER, A PUNO SITE-OVA JE NAPRAVLJENO SAMO ZA INTERNET EKPLORER, MI SMO MOZILLA ILI SAFARI" ILI TAKO NEŠTO, TAKO DA SU LAŽIRALI

MOZILLU SU STAVILI U HEADER, IAKO JE U OVOM SLUČAJU OVO CHROME PREGLEDAČ, ALI I DALJE PIŠE MOZILLA 5.0 JER POKUŠAVA LAŽNO PREDSTAVLJATI SEBE. A POŠTO JE WEB [BACKWORDS COMPATABILE](https://en.wikipedia.org/wiki/Backward_compatibility), THEY KEPT IT, A ON SAMO POSTAJE SVE DUŽI I DUŽI, A NIKAD NIJEDNA KOMPANIJA NIJE REKLA, HEJ, TO ĆEMO POPRAVITI DANAS, TO ĆEMO POPRAVITI JER JE SADA IMA TOLIKO RAZLIČITIH PREGLEDAČE I NIKO SE NE SLOŽE KAKO TREBA DA  IZGLEDA User-Agent

ALI STVARNO User-Agent JE DA GA KORISTIMO ZA UVID U VERZIJU PREGLEDAČA U KOJOJ SE NALAZIMO, KOJE SU KARAKTERISTIKE PODRŽANE I KAKAV JE PRETRAŽIVAČ U OSNOVI. GENERALNO ĆETE KORISTITI NEKU VRSTU LIBRARY PARSER-A ZA User-Agent, JER SU ONI UGLAVNOM NEČITLJIVI

POVUKAO SAM ONA JPRIMER User-Agent A IZ PREGLEDAČA GOOGLE CHROME, ALI IZGLEDA KAO DA BI BILO VRLO TEŠKO REĆI KOJI JE PRETRAŽIVAČ, DA LI JE TO CHROME, DA LI JE TO SAFARI, JE LI TO MOZILLA? TO NIKO NE ZNA, PA KORISTITE BIBLIOTEKU AKO POKUŠAVATE DA SNIFF-OVANJE User-Agent. ALI OPET, DOBRO JE ZA FEATURE SUPPORT, TAKO DA AKO ŽELIM UKLJUČIM TOP LEVEL async/await, KOJI V8 SADA PODRŽAVA, ALI NIJE SUPPORTED ON OTHER BROWSERS

ZATO MOGU KORISTITI NEKU VRSTU User-Agent SNIDFFING ILI DRUGE METODE.

### Accept HEADER

ON KAZE, "KAO PREGLEDAČ, WHAT SORT OF THINGS MOGU DA PRIMIM SA SERVERA?

>> Because not all web browsers support all the same protocols, but the accept header is usually generated by the browser itself

ON SAMO KAŽE - "HEJ, ZNATE ŠTA ĆU UZETI; HTML U TOM TEKSTUALNOM FORMATU"

KORISTIMO GA ZA RAZLIČITE TIPOVE PODRŽANIH FORMATA

### Accept-Encoding HEADR

TO SAMO ZNAČI DA CURRENT PRETRAŽIVAČ PRIHVATA, NA PRIMER GZIP KODIRANJE, PA ĆE Nginx REĆI " I've got a request here and it'll actually take gzips on the way out, I'm gonna gzip that up because I know Browser can handle that."

BACK IN THE DAY NIJE SVAKI PREGLEDAČ PODRŽAVAO GZIP

U SLUČAJU PRIMERA KOJEG SAM PRIAKZAO, JER JA KORISTIM CHROME KAO User-Agent, TAJ BROWSER ALOS ACCEPTS brptli,

```linux
Accept-Encoding: gzip, br
```

O ČEMU SMO RANIJE GOVORILI KAO O  ALTERNATIVN-OM FORMAT-U KOMPRESIJE (IZMIŠLJENO U ŠVAJCARSKOJ) (brotli ZNACI LITTLE BREAD)

HEJ, AKO Nginx, ILI Apache, ILI BILO KOJI DRUGI WEB SERVER KORISTI brotli, VEROVATNO GA PODRŽAVA, I MOJ BROWSER

HEADER SU STVARNO KORISNI, JER ONI SU NAČIN DA SE VRATIM NA RAZLIČITE STVARI

I OPET, SVE OVO SE NALAZI U HEADERIMA, KAO I SVI OVI METAPODACI O SAMOM REQUEST-U

### Accept-Language HEADER

KAKVE JEZIKE OČEKUJEM TO GET BACK, I OBIČNO SU AUTO POPULATED BY THE BROWSER I WHATHEVER LANGUEGE STE SET-OVALI U BROWSER-U ILI VAŠEM OPERATIVNOM SISTEMU

## COMMON HEADERS NA LOJE CE TE NAICI

User-agent &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The requesting device type

Accept &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What the device will handle

Accept-language &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Browser languages

Content-type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The type of media

Set-cookie &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets stateful information

X- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Typically used for custom headers

## ONO O KOME NISAM GOVORIO JE **Set-Cookie** KOJI POSTAVLJA KOLAČIĆE

ZAŠTO SU KOLAČIĆI NA NEKI NAČIN VAŽNI ZA VEB?

ILI DA KAŽEM ŠTA JE KOLAČIĆ

*TO JE DEO METAPODATAKA, ALI IDE NA SVAKI SLEDEĆI (SUBSEQUENT) REQUEST, I TO SE MOŽE INSPECT-OVATI I NEKAKO SE MANGE-OVATI NA STRANI SERVERA*

TAČNO, TO JE TRAJNI DEO TEXT DATA-E KOJI PERSISTS NA BROWSER-U, ZAVISNO OD TOGA DA LI SE RADI O 

- **SESSION COOKIE**-U, (ŠTO ZNAČI U TRENUTKU KADA ZATVORITE TAB ILI BROWSER, BIĆE OBRISANO)

ILI

- **REGULAR COOKIE**-U, KOJI ĆE ISTRAJATI (PERSISTS) TOKOM VREMENA, I ISTEĆE, ODNSONO EXPIRE-OVACE SVAKI PUT KADA ZA KOLAČIĆE PODESITE DATUM ISTEKA

## ALI ZAŠTO JE KOLAČIĆ VAŽAN? U STVARI, TO JE OD PRESUDNE VAŽNOSTI ZA WEB, AZASTO?

NE BISMO MOGLI DA OPERATE THE WEB BEZ KOLAČIĆA

ON DOZVOLJAVA DA BRING-UJETE DATA IZMEĐU SERSSION-A I TAKO, PROŠIRUJE USER EXPERIANCE ACROSS DIFFERENT SESSIONS

TAČNO

## POSTOJI NEŠTO O ČEMU NE RAZMIŠLJAMO KAO WEB DEVELOPRI, A TO JE DA JE INTERNET STATELESS

SVAKI REQUEST I RESPONSE JE POTPUNO NOV REQUEST I RESPONSE

SERVER NE PAMTI DA STE BILI OVDE ILI NE

ZA RAZLIKU OD TOGA, POSTOJE DRUGE PROGRAMSKE PARADIGME, GDE POSTOJI STATE I KAD GOD KORISNIK ODE, TOG STANJA VIŠE NEMA

ALI WEB DAKLE STATELESS, TO JE NEŠTO O ČEMU NE MISLIMO DA POSTOJI, TAKO DA SU NAM POTREBNI KOLAČIĆI DA PERSIT-UJU DATA, OVER TIME, DA BISMO ZNALI, RECIMO DA LIS OSOBA PRIJAVLJENA ILI SU ODJAVLJENI ILI SU PRIHVATILI 'I Accept Cookie' BANER KOLAČIĆA,KOJI SVI SADA MORAMO DA SERVIRAMO, ZBOG PROPISA ILI SLIČNIH STVARI

OPASNOST OD KOLAČIĆA OGLEDA SE U TOME DA KOLAČIĆI PERSIST-UJU, PRI SVAKOM ZAHTEVU, OSIM AKO IH NE EXPIRE-UJETE

I LOŠE U TOME JE ŠTO MOŽETE DA NAPRAVITE ZAISTA JEDNOSTAVAN REQUEST, KAO ŠTO JE "ŽELIM HTML PAGE OD 2 KILOBAJTA, ILI 10 KILOBAJTA, AKO STAVITE PUNO KOLAČIĆA UNUTRA", JER SE ŠALJU NA SVAKI POJEDINAČNI ZAHTEV

*****

TIP ZA WEB DEVELOPERI ILI FULL STACK ENGINEERS:

PAZITE NA KOLIČINU KOLAČIĆA KOJE ŠALJETE I NE DODAJTE PREVIŠE PODATAKA TAMO JER ĆE SE SLATI NA SVAKI ZAHTEV I SAMO DODAJETE OVERHEAD I USPORAVATE KONEKCIJU

*****

IMA PUNO I PUNO I PUNO ZAGLAVLJA, SAMO SE DOTIČEM NEKIH OD NJIH

## X- JE TAKODJE HEADER

X JE OPŠTA SMERNICA (GUIDELINE) O TOME KAKO SET-OVATI CUSTOM HEADER-E

TAKO DA AKO ŽELITE DA POSTAVIM "rade je bad boy" HEADER, KORISTIO BIH X CRTICA "rade je bad boy", I STAVIO BILO KOJU VRSTU PODATAKA KOJE ŽELITE

KORIŠĆENJE PRILAGOĐENIH ZAGLAVLJA JE DOBAR NAČIN SLANJA ONE TIME CUSTOM DATA ZA KOJE NECESSARILY NE ZELIMO PAYLOAD, ALI ŽELIMO DA BUDU DECRYPTED BY THE BROWSER

TO JE NEŠTO ŠTO STE VEROVATNO VIDELI, AKO STE VEROVATNO VIDELI x-nesto HEADER, TO SAMO ZNAČI DA JE TO PRILAGOĐENO HEADER, BROWSER VEROVATNO NE ZNA ŠTA DA RADI SA NJIM. Nginx VEROVATNO NE ZNA ŠTA DA RADI S NJIM, ONAJ KOJI ĆETE NAJČEŠĆE VIDETI, PA HAJDE DA OTVORIMO NAŠU VEB STRANICU I DA VIDIMO DA LI MOŽEMO DA VIDIMO PRILAGOĐENO HEADER TAMO

ZNAČI, JA SAM NA SVOJOJ VEB STRANICI

OSVEŽITI OVU STRANICU, GLEDAJUCI U NETWORK TAB DEVELOPER TOOLS-A I HAJDE DA PROVERIMO HEADER REQUEST-A

NA RESPONSE-U SAM PRONASAO

**X-Powered-By**: Express

Powered-By NIJE OFICIJALNI HTTP HEADER, SA KOJIM BTOWESER ZNA WHAT TO DO

EXPRESS JE DAKLE OVO SAMO TAGED ON, DA BISTE ZNALI DA, "HEJ, APLIKACIJA SERVIRANJA KORISCENJEM Express-A"

DAKLE, AKO VAM TREBA DA POŠALJETE CUSTOM ONE TIME DATA KORISTEĆI X- HEADER, TO JE DOBAR NAČIN DOING IT

## Response IZGLEDA NESTO DRUGACIJE I HEADERS CE BITI NESTO DRUGACIJI

REQUEST HEADERS GOVORE ALL ABOUT "WHO AM I AS A ABROWSER", "WHERE AM I GOING", "WHERE AM I TRYING TO GET", "KOJE VRSTE TEHNOLOGIJA I STANDARDA PODRŽAVAM"

*RESPONSE HEADERS SU ONO ŠTO VAM ŠALJE SERVER, PA RECIMO DA JE CONTENT ENCODED GZIP-OM, PREGLEDAČ NE BI ZNAO DA AKO NE POSTAVIMO HEADER KOJE KAŽE DA JE Content-Type ENKODIRAN KAO GZIP, NE BI ZNAO KAKO DA GA UNPACK-UJEMO

DAKLE, ZAGLAVLJA ODGOVORA SU JEDNAKO VAŽNA KAO I ZAGLAVLJA ZAHTEVA
