# PROXY PASSING TRAFFIC

DAKLE JA SAM NAPISAO EXPRESS APP (POKAZANO U PROSLOM MD FAJLU)

SADA CU RUNN-OVATI APP

- node app.js

IT'S RUNNING I TO JE COOL, I SADA IDEM NA MOJ WEBSITE, REFRESH-UJ PAGE, I NIST SE NECE DOGODITI

APP IS RUNNING

STA SE DESAVA

## PA NE RUNN-UJES NA CORRECT PORT-U, JER DEFAULT PORT JE PORT 80, A TI RUNN-UJES APP NA PORTU 3000

PROBAJ DA U ADRESS BAR DODAS I :3000 PORED DOMAIN NAME-A

I SADA KADA UDARIS ENTER, VIDECES DA CE NA STRANICI BITI RENDERED "Hello Word!", A RANIJE NA PORT-U 80 (NA DEFAULT-U), TO JE BILO "Zdravo svima!"

DAKLE SADA RADI

## ALI TO NIJE CONVINIENT, JER NE MOGU DA BUILD-UJEM APP I KAZEM: IDI NA MOJ WEBSITE, ALI MORAS DOCI NA PORT 3000

JER TVOJA ZAOVA CE PITATI: "STA JE TO PORT?"

## MORAM NEKAKO DA DIRECT TASJ TRAFFIC TO PORT 80

IMAM

- DOMAIN

- IP

ZATIM

- Nginx IS RUNNING

**ALI ONO STO JA MORAM DA URADIM JESTE DA KONEKTUJEM *Nginx* TO *Express***

## TUNE-OVACU Nginx DA BI POINT-OVAO TO CORRECT PORT, I ZA TO CU KORISTITI *DIRECTIVES*

'DIRECTIVES' JE BILA REC KOJA JE UPOTREBLJENA RANIJE TOKOM KONFIGURIRANJE Nginx-A

DIREKTIVA KOJU CU KORISTITI JESTE 

**proxy_pass**

```linux
locatoon / {
    proxy_pass URL_DO_KOJEG_PROXY-UJEM
}
```

URADICU, USTVARI SLEDECE:

PROXY-OVACU SAV TRAFFIC, KOJI DOLAZI NA *'/'* (GENERAL ROOT DOMAIN), I USMERICU GA TO THE ACTUAL Node SERVER, NA DIFFEREN PORT-U

DAKLE OVAJ CHANGE JE FEALY SHORT

**JA CU USTVARI SADA UCI U KONFIGURACIJSKI FAJL Nginx, ZATIM CU PRONACI location BLOK IS KOJEG CU UKLONITI SVE I SAMO CU DODATI**

proxy_pass http://127.0.0.1:3000/

**NE OVO GORE NIJE TVOJ IP** (CISTO DA ZNAS)

URADI TO SADA I OBRATI PAZNJU DA GORE NEMA DVE TACKE IZMEDJU proxy_pass I URL-A (OVO MOZES RADITI BIL OGFDE DA SI JER PATH JE POTPUN DOLE)

- sudo vi /etc/nginx/sites-available/default

KADA UKLANJAS STVARI U VIM-U

MOZES JOS DOK SI U COMMAND MODE-U DA ODES STRELICAMA, NA RED KOJI ZELIS U TEKSTU

KUACAS

- d

BEZ DVE TACKE, I EXECURE-UJES

TO CE UKONITI CEO RED

POSLE TOGA MOZES U INSERT MODE

- i

I SAMO SADA DODAJ ONO STO SAM GORE REKAO

******

digresija:

AKO IMAS ERROR U KONFIGURACIJSKOM FAJLU, AKO SI GA LOSE EDITOVAO

MOZES POKRENUTI KOMANDU

- sudo nginx -t

*MENI JE PRONASLA NA LINE-U 50 DA SAM KUCAO `{` VISKA*

TO SAM ISPRAVIO

NGINX MI JE UKAZO PRVO DA IMA GRESKU I NIJE HTEO ZBOG TOGA DA SE RELOAD-UJE

**DOBRA STVAR U VEZI Nginx-A, JESTE DA KADA IMA MERROR U KONFIGURACIJI, THROW-OVACE ERROR BEFORE IT LETS YOU RESTART, I NA TAJ NACIN TVOJ SERVER KEEPS UP AND RUNNING, STO JE PRETTY NICE**

******

SA POMENUTOM proxy_pass DIREKTIVOM. SVE STO GOVORIM JESTE 'HEY , BILO KOJI REQUEST-OVI, KOJI DOLAZE NA /' (MI SADA IMAMO SAMO JEDAN REQUEST SADA), DOZVOLI DA SE FORWARD-UJE, KAK OBI MOJA NODEjs APLIKACIJA HANDLE-OVALA, I TO JE NA RAZLICITOM PORT-U'

OVIM NACINOM JA NISAM MORAO DA CHANGE-UJEM PORTS, I NE MORAM TO RUN IT ON PORT 80, ILI ANYTHING LIKE THAT

MOGU GA RUN-OVATI NA DRUGOM PORT-U I I NGNX, ZNA EXACTLY WHERE THEY'RE HANDLED

>> And the benefit of doing something like this is I can run six different applications and they all run on a different port they're all running at the same time.

>> And I can take one application down, bring another one up, I can route to a database. Most of what we're doing is gonna be with the proxy_pass directive, at least for today.

## ZABORAVIO SAM DA RESTARTUJEM SERVER

KUCAO SAM 

- sudo service nginx restart (MISLIM DA SAM OVO MORAO DA RUNN-UJEM ZBOG JEDNOG MISTAKE-A KOJEG SAM NAPRAVIO)

*TI IPAK SAMO RUNN-UJ RELOAD*

- sudo service nginx reload

## POKRENI SADA TVOJU NODE APLIAKCIJI

- node app.js

I SADA MOGU DA VIDIM DA SE NA STRANICI RENDER-OVALO ONO STO SAM PODESIO DA SE POSALJE KROZ EXPRESS

NICE

>> Jem Young: Nice. So now I have my domain connected to my Express application running on port 80. Not bad. If you're running into troubles, don't forget to restart Nginx. Don't forget to start your Node application back up

**TO JE MOZDA PAIN I MORACEMO DA FIGURE OUT NACIN, KAKO TO GET AROUND RESTARTING MY APPLICATION**

******

O KOMANDAMA:

**service** JE HIGHEST-LEVEL COMMAND ZA BILO KOJU VRSTU DAEMON-A, KOJI RUNN-UJE IN THE BACKGROUND

>> You can do lots of things with services. I can register my Node application as a service that's running in the background

******

U NASTAVKU MU POSTAVLJAJU JOS PITANJA; PA TI OPET ODGLEDAJ VIDEO

GOVORI SE O FOLDERU sires_enabled, I KOJA JE RAZLIKA IZMEDJU avilable SITES I enabled SITES

ZATIM GOVOR IDA SE U PRAKSI NE TREBA MODIFIKOVATI DEFAULT KONFIGURACIJA, VEC NAPRAVITI NOVA KOJA SE MEGE-UJE SA DEFAULT-OM

JEM TAKODJE JESTE SPOMENUO I KOMANDU: `sudo nginx -t` KOJU SAM JEDNOM UPOTREBIO ALI POSLUSAJ I NJEGA STA IMA DA KAZE O NJOJ

## ONO STO BI MORAO DA SAZNAM JESTE STA 127.0.0.1 STVARNO PREDSTAVLJA

AKO TO NISI SHVATIO TI SI USTVARI DEFINISAO proxy_pass ZA SLEDECI PATH **/**

I TO TI UPRAVO GOVORI SLASH **/**, PORED RECI location

```linux
locatoon / {
    proxy_pass http://127.0.0.1:3000/
}
```

ALI STA PREDSTAVLJA *http://127.0.0.1*

**http://127.0.0.1** JESTE **localhost**

TO JE USTVARI ISTI ONAKAV localhost KOJI SI KORISTIO ZA TVOJ LOCAL DEVELOPMENT, NA TVOM KUCNOM RACUNARU

STVARI SADA POCINJU DA IMAJU VISE SMISLA
