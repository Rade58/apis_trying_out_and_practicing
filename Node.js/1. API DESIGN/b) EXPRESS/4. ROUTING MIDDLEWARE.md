# ROUTING MIDDLEWEAR

U PROSLOM DOKUMENTU SAM VIDEO MAL OROUTINGA

A SADA CU DIVE-OVATI DEEPER U ROUTING I VIDETI KAKO JE TO LAKO SA EXPRESS-OM

TO JE AUTORU WORKSHOP-A, OMILJENI DEO EXPRESS-A; CA KJE I NA DRUGI MPROJEKTIMA KOJI NEMAJ UVEZE SA EXPRESSOM, KORISTIO PAKET KOJI SE ZOVE express-routing

## PRVO DA VIDIM STA JE TO **MIDDLEWARE**

TO JE USTVARI SOFTWARE DESIGN PATTERN, KOJI JE EXPRESS USVOJIO I POPULARIZOVAO, ALI NIJE KREIRAN BY EXPRESS

**IT'S A LIST OF FUNCTIONS, KOJE SE EXECUTE-UJU IN ORDER, PRE TVOJIH CONTROLLER-A** (CONTROLLER-I SU ONE FUNKCIJE `(req, res) => {}`)

**ZNACI DA JE MIDDLEWARE, LISTA FUNKCIJA, KOJE RUNUJE BEFORE, POMENUTE FUNKCIJE**

*MOGU O NJIMA DA RAZMISLJAM KAO O **INTERCEPTORIMA ZA ROUTE-OVE***

>> WHEN THIS REQUEST COMES: RUNUJ OVU FUNKCUIJU, PA OVU FUNKCIJU, I NAPOKON RESPOND-UJA SA OVOM (`(req, res) => {}`) FUNKCIJOM

*LISTA FUNKCIJA KOJE SITT-UJU BETWEEN MY REQUEST AND RESPONSE*

## STA TI MIDDLEWARE KONCEPT OMOGUCAVA

- OMOGUCUJU TI DA, GARANTOVANIM REDOM EXECUTE-UJES FUNKCIJE, ON AN INCOMING REQUEST

RED JE DAKLE VAZAN, JAR SE MOZDA JEDAN MIDDLEWARE, RELAY-UJE NA PREVIOUS ONE; KAK OBI URADIO NEKI ENHANCEMENT NA REQUEST OBJEC-TU, ILI DA URADI NEKI LOGGING, ILI ODRADI NEKI DATABASE QUERY, PRE NEGO STO SE SLEDECI EXECUTE-UJE

- SJAJAN JE ZA AUTHENTICATING, TRANSFORMING THE REQUEST (TAMO GDE SE KORISTI .use() METODA; E PA TO TI JE SVE TRANSFORMISANJE REQUEST-A (NA JEDNOM MESTU JE TRANSFORMED DA BI KORISTIO cors() I TO SU SVE MIDDLEWEARI KOJE JE AUTOR WORKSHOP-A INSTALIRO, KAKO BI TRANSFORMISAO REQUEST, WHEN IT COMES IN)), TRACKING

```javascript
import express from 'express'
import { json, urlencoded } from 'body-parser'
import morgan from 'morgan'
import cors from 'cors'

export const app = express()

app.disable('x-powered-by')

/**
 * DAKLE OVO SLEDECE JE UPOTREBA MIDDLEWARE-A
 */
app.use(cors())     // OVO ZNAS STA JE
app.use(json())     // OVO OVDE TI JE OMOGUCILO DA MOZES DA KORISTIS    req.body   (DA OVOGA NEMA BILO BI PUNO POSLA)
app.use(urlencoded({ extended: true })) // NISAM GA KORISTIO, A OMOGUCAVA DA KACIS PARAMETRE NA URL
                                        // MISLIM DA SAM GA VIDEO U UPOTREBI (querystring-OVI)
app.use(morgan('dev'))    // OMOGUCAVA MI LOGG-OVANJE NA SERVER-U
                          // AKO SI U TERMINALU U OUTPUT-U VIDEO NA PRIMER 
                                          //       POST /data 200 10.364 ms - 35
                                            // KAO STO VIDIS IMAS I TIME U INFO-U

/**
 * I ONI SU DEFINISANI BEFORE MY ROUTES
 * ONI SE DOGADJAJU PRE
 */


app.get('/', (req, res) => {
  res.send({ message: 'zdravo' })
})

app.post('/', (req, res) => {
  console.log(req.body)
  res.send({ message: 'ok' })
})

app.get('/data', (req, res) => {
  res.send({ message: 'hello mars' })
})

app.post('/data', (req, res) => {
  console.log(req.body)
  res.send(req.body)
})

export const start = () => {
  app.listen(3000, () => {
    console.log('server ti je na 3000')
  })
}
```

>>>> So all these middleware don't really respond to the requests. They just transform the request then they go to the next one, in that order.

- ONI TAKODJE MOGU DA RESPOND-UJU NA REQUEST, KAO STO BI TO URADIO I CONTROLLER, AL ITO NIJE NJIHOVA NAMENA (KOD NEUSPESNEOG AUTHERNTICATION-A SE OVO MOZE KORISTITI)