# ROUTER I SUB ROUTERI

ZA ABSTRAKCIJE, A TO CU RADITI SADA, MOGU KREIRATI SUB ROUTERE

POSTO CU IMATI MNOGE RAZLICITE RESURSE ZA MOJ REST API, MOGU KREIRATI SUB ROUTERE

TO MI OMOGUCAVA DA DIFFERENT PART OF MY API, IMA ITS OWN ROUTER, ILI IT'S OWN MIDDLEWARE STACK

ON JE SAM SVOJA STVAR, BIO OPT IN DA DA INHERIT-UJE FROM A PARENT ROUTER ILI NE

MOGU O NJEMU RAZMISLJATI KAO O NESTED ROUTER-U; ILI AKO O ROUTE-AMA RAZMISLJAM KAO O TREE-JU, OVO BI TREBALA DA BUDE SAMO BRANCH NA TOM ROUTE-U

>>>> It still comes from the tree, but it's got its own branch, its own rules, its own everything

**EXPRESS DAKLE OMOGUCAVA DA TO URADIS VERY SIMPLE**

## OMOGUCENO TI JE DA SEPARATE-UJES, TVOJ CODE I ABSTRACTUJESG, VEOM NEAT

I MOZES DA COLOCATE NA ODREDJENIM MESTIMA; AKO IMAS FOLDER SA SVIM TVOJIM RAZLICITIM RESURSIMA (KOJE CU I JA IMATI U MOJIM VEZBAMA)

## DAKEL NE MORA, A I NE TREBA SVE DA BUDE U JEDNOM FAJLU

MOGUCE JE DA IMAM I PO 500 REDOVA CODE-A FULL OF ROUTES, I BOLJE JE TAJ CODE PODELITI U RAZLICITE FAJLOVE

## :one: DA KREIRAM ROUTER, KORISTIM METODU Express.Router

```javascript
const router = express.Router()

// I EVO OVDE SAM KREIRAO ROUTER

```

REKAO SAM RANIJE DA JE KONTROLER I MIDDLEWARWE U SUSTINI ISTO, SAM OSTO JE RAZLICIT INTENT, ODNOSNO KORISTE SE NA RAZLICITE NACINE

ISTO JE I SA *app-OM* (**express()**) I SA ROUTER-OM (express.Router()); DAKEL SAMO JE INTENT RAZLICIT

```javascript
import express from 'express';

const app = express();

const router = express.Router();
```

### ROUTER MOZE RADITI STVARI KAO STO SU LISTENING ON A PORT

ALI STO SE TICE REGISTROVANJA ROPUTE-OVA I VERB KOMBINACIJA, ROUTER MOZE RADITI SVE ISTO, KAO I APP

DA BIH TO POKAZAO KREIRACU NEKE ROUT-OVE NA NOVOM ROUTER-U

```javascript
router.get('/sheese', (req, res) => {
    res.send({message: 'cheese'})
})
```

SVE STO SAM JA URADIO JESTE KREIRANJE ROUTERA, I KREIRANJA ROUTE-A NA NJEMU

**ALI SADA JE OVAJ MOJ ROUTER DISCONNECTED**

ZATO SADA ON NICEMU NE SLUZI

## DAKLE JA MORAM REGISTROVATI OVAJ NOVI ROUTER SA ROOT ROUTER-OM ,A TO JE U MOM SLUCAJU app (KONVENCIJA JE DA SE ROOT ROUTER UVEK DEKLARISE KAO app)

'IT'S A LEAF FLOWING SOMEWHERE,  IMORAM GA ZAKACITI NA TREE'

ISTO KAO STO SAM URADIO SA MIDDLEWARE-OM, GDE SAM KORISTIO PRINCIP ZVANI 'MOUNTING'

**TO JE ONO KORISCENJE use METODE**

```javascript
import express from 'express';

//////////////////////////////////////
const app = express()

const router = express.Router()

// EVO MOUNT-UJEM ROUTER

app.use('/api', router)

//////////////////////////

router.get('/cheese', (req, res) => {
    res.send({message: 'cheese'})
})
```

**OVIM GORE SAM REKAO SLEDECE:**

*"HAJDE DA KORISTIM OVASJ MIDDLEWARE, FOR EVERY ROOT, FOR EVERY PATH (OVDE NEMA KOMBINACIJA)"*

VIDIS GORE DA SAM PROSLEDIO PATH

- **AKO REQUEST DODJE ZA ANY VERB, KOJ IMA NA SEBI `'/api'` *ZELI MDA KORISTIM ROUTER, KOJI SAM KREIRAO***

>> IT'S GOING TO DELEGATE TO THAT

### MOZES SADA DA TESTIRAS OVO TAKO STO CES IZ INSOMNIO POSLATI GET REQUEST NA '/api/cheese'

I SVE JE U REDU

AKO POKUSAS DA SALJES REQUEST ZA NESTO DRUGO NA PRIMER SAMO '/api' ILI SAMO '/cheese' DOBICES 404 ERROR

### AKO HOCU DA REGISTRUJEM MIDDLEWARE NA ROUTERU (POSTO ROUTER RADI ISTO ONO STO I APP RADI), JA GA MOGU DODATI NA SVE ONE NACINE, KOJE SAM NAVEO DA SE MOGU KORISTITI PRI REGISTROVANJU MIDDLEWARE-A

```javascript
import express from 'express';

const app = express()

const router = express.Router()

//*********************EVO GLEDAJ*************
router.use(function(req, res, next){
    console.log('middleware on router')
    next()
})
//**********************************


app.use('/api', router)

router.get('/cheese', (req, res) => {
    res.send({message: 'cheese'})
})
```

### ZAPAMTI JOS JEDNOM DA TI ROUTER PRVENSTVENO SLUZI DA NE BI MORAO SVE STAVLJATI U JEDAN FAJL

OVAKO MOZES DA DEFINISES ROUTER U JEDNOM FAJL I DA MU REGISTRUJES SVE MIDDLEWARE-OVE I REGISTRUJES SVE CONTROLLERE

I NA KRAJU GA SAMO UVEZES U FAJL GDE JE TVOJ ROOT ODNOSNO GDE JE app I KONEKTUJES ROUTER ZA APP

ILI AKO JEDAN DEO TVOG API IMA IT'S OWN SET OF RULES, KOJE ZELIS DA IZOLUJES SAM OZA TAJ PART, ONDA PRAVIS NOVI ROUTER

>>>> For instance, let's say you had an API that serves static assets that also serves json, it served this proprietary machine learning thing. And the json one had a different authentication strategy than a machine learning one did, right? So if you added the authentication strategy as middleware to the route, it'll lock the whole API down.

*TI BI ONDA NAPRAVIO DVA ROUTER,A ZA DIFFEREN AUTHENTICATION STRATEGIES*

I ONE SE ONDA NECE CONFLICT-OVATI

> ako te zanima koj ije problem pomenuo speaker, vrati se na video jer ja necu da pisem dodatne stvari ovde vise

U SUSTINI LOGICNO JE DA JE MOGUCE I OVAKO NESTO

```javascript
app.use('/foo', router)

app.use('/bar', router)
```
